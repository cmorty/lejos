<!-- ant file to make libnxt, runc, nxjflash and jlibnxt -->

<project name="libnxt" default="make" basedir=".">
	<!-- cpptasks task & type def
	<taskdef resource="cpptasks.tasks">
	  <classpath>
	    <pathelement location="../release/lejos_nxj/3rdparty/lib/cpptasks.jar"/>
	  </classpath>
	</taskdef>
	<typedef resource="cpptasks.types">
	  <classpath>
	    <pathelement location="../release/lejos_nxj/3rdparty/lib/cpptasks.jar"/>
	  </classpath>
	</typedef>
	-->
	<taskdef resource="cpptasks.tasks"/>
	<typedef resource="cpptasks.types"/>
	    	
	<!-- cleans all compilation artifacts -->
	<target name="clean" description="cleans all compilation artifacts">
		<delete>
			<fileset dir=".">
				<include name="*.o"/>
			</fileset>
		</delete>
	</target>
	
	<!-- make libnxt and its utilities --> 
	<target name="make" depends="clean,jlibnxt" description="makes libnxt and its tools">
	</target>
	
	<!-- make jlibnxt --> 
	<target name="jlibnxt" description="makes jlibnxt">
  		<cc subsystem="console" 
  				outfile="jlibnxt"
  				objdir="." 
  				outtype="shared" 
  				debug="false"
  			    exceptions="false"
  			    rtti="true"
  				name="gcc">
  			    <compilerarg value="-Wall"/>
  			    <compilerarg value="-std=c99"/>
   			    <!-- added by cpptasks: <compilerarg value="-fPIC"/> -->
  			    <linkerarg value="--strip-all"/>
  			    <linkerarg value="--version-script=symbols-gnu.txt"/>
  				<fileset file="jlibnxt.c"/>
				<libset libs="usb"/>
  				<includepath if="jni.include.dir">
					<pathelement location="${jni.include.dir}" />
  				</includepath>
  			    <includepath if="jni.sys.dir">
					<pathelement location="${jni.sys.dir}"/>
				</includepath>
  		</cc>
	</target>
</project>

