<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		
  <title>Getting Started on Microsoft Windows</title>
  <!-- CSS -->
  <link rel="stylesheet" href="../r_css/lejos-tutorial.css" type="text/css" /><!-- ICONO -->
  <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon" />
</head>
<body>
<a id="top" name="top"></a>
<!-- N1: HEADER -->
<table class="n1t1" cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td><img src="../r_media/images/tutorial_header1.jpg" /></td>
      <td align="right"><img src="../r_media/images/tutorial_header2.jpg" /></td>
    </tr>
  </tbody>
</table>
<!-- N2: CONTENTS -> NAVIGATION SYSTEMS AND CONTENTS -->
<table class="n2t1" cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td class="n2t1r1c1">
      <div class="nolinkLESSON">Getting Started on Microsoft Windows</div>
      <div class="linkAHEAD"><a href="#1">Prerequisites</a></div>
      <div class="linkAHEAD2"><a href="#2">USB Driver</a></div>
      <div class="linkAHEAD2"><a href="#3">Java Development Kit</a></div>
      <div class="linkAHEAD2"><a href="#4">Bluetooth Stack</a></div>
      <div class="linkAHEAD"><a href="#5">Downloading the software</a></div>
      <div class="linkAHEAD"><a href="#6">Running the GUI Installer</a></div>
      <div class="linkAHEAD"><a href="#7">Manual installation</a></div>
      <div class="linkAHEAD2"><a href="#8">Unzipping the release</a></div>
      <div class="linkAHEAD2"><a href="#9">Setting up environment variables</a></div>
      <div class="linkAHEAD2"><a href="#10">Using a Command Window</a></div>
      <div class="linkAHEAD2"><a href="#11">Flashing the firmware</a></div>
      <div class="linkAHEAD"><a href="#12">Testing your Installation</a></div>
      <div class="linkAHEAD2"><a href="#13">Compiling and running your first program</a></div>
      </td>
      <td>
        <div id="BreadCrumbs">
            <a href="../index.htm" target="_top">Home Page</a>&gt;
            <a href="#">Getting Started on Microsoft Windows</a>
        </div>
      <div class="NavBit"> <a target="_top" href="../Preliminaries/Intro.htm">«&nbsp;Previous</a>&nbsp;&#8226;&nbsp;
      <a href="../index.htm">TOC</a>&nbsp;&#8226;&nbsp;<a href="../Preliminaries/FirstProgram.htm">Next&nbsp;»</a> </div>
      <div id="PageTitle">Getting Started on Microsoft Windows</div>
      <p>This version of the tutorial is for the 0.9 release of leJOS NXJ. </p>
      <a id="1" name="1"></a>
      <h4>Prerequisites</h4>
      <a id="2" name="2"></a>
      <h5>USB Driver</h5>     
      <p>To run leJOS NXJ on Microsoft Windows you will need a suitable USB driver on your PC. 
      If you have installed the standard LEGO Mindstorms NXT-G software, a suitable driver (the so-called Fantom driver) is already installed. 
      If you do not wish to install the LEGO software on your PC or if you want to update the Fantom driver to the latest version,
      you can get an installer from <a href="http://mindstorms.lego.com/en-us/support/files/Driver.aspx" target="_blank">The LEGO Mindstorms site</a>.
      </p>
      <p>It has come to our attention, that NXT-G as well as the Fantom driver don't install under Windows 7 Starter Edition.
      This can be worked around by adding a line to the setup.ini file.
      <a href="http://digital.ni.com/public.nsf/allkb/1817F501D7BA67F28625768F0000B260">Here</a> you find the official instructions
      by National Instruments, the authors of NXT-G and the Fantom driver. In short, you have to add <code>AllowWindowsStarter=1</code>
      to the [OS]-section of the setup.ini file.</p>
      <a id="3" name="3"></a>
      <h5>Java Development Kit</h5>     
      <p>You will also need a Java Development Kit (JDK) on your PC. 
      Note that a Java Runtime Environment (JRE) is not sufficient 
      as it does not allow you to compile Java programs. You can download
      the latest JDK from <a href="http://www.oracle.com/technetwork/java/index.html" target="_blank">http://www.oracle.com/technetwork/java/index.html</a>.
      Follow the instructions for installing it. leJOS NXJ has been
      tested with JDK versions 1.5 and 1.6, and will not work with earlier
      versions. JDK 1.6 is recommended, and some PC sample programs will not work with JDK 1.5.</p>
      <p>leJOS NXJ only works with 32-bit version of the JDK and JRE, so even if you have a 64-bit system,
      you should select a 32-bit version of the JDK.</p>
      <p>You will need to add the JDK bin directory to your system or user PATH,
       so that commands such as <code>javac</code> and <code>java</code> can be called from a command prompt. If you do not know how to do this, 
       see the "Setting up environment variables" section below.</p>
       <p> You should set the environment variable JAVA_HOME to the folder where you installed the JDK. If you have multiple JDKs on
       your PC, and do not want to change JAVA_HOME, you can set LEJOS_NXT_JAVA_HOME instead.</p>
      <a id="4" name="4"></a>
      <h5>Bluetooth Stack</h5> 
      <p> If you want to communicate with the NXT over Bluetooth, you will need a Bluetooth dongle or built-in support on your PC, 
      and a Bluetooth software stack. leJOS NXJ has been tested with the Microsoft and Widcomm stacks, but should work with others. </p>
      <p> You can use leJOS NXJ without Bluetooth.</p>
      <p> <a href="#top">Back to top</a> </p>
      <a id="5" name="5"></a>
      <h4>Downloading the software</h4> 
      <p>You can download the leJOS NXJ software from <a href="http://lejos.sourceforge.net/nxj-downloads.php" target="_blank">
      The leJOS NXJ download page</a>.</p>
      <p>It is recommended that you use the Windows installer, but there is a ZIP file release that you can use if you prefer to do a manual installation.</p>
      <p> <a href="#top">Back to top</a> </p>
      <a id="6" name="6"></a>
      <h4>Running the GUI installer</h4>
      <p> Run <code>leJOS_NXJ_0.9.0-Setup.exe</code> and you will see the following screen:
      </p>
      <img src="installquestion.jpg"/>
      <p> Select "Yes" and you will see:</p>
      <img src="installwelcome.jpg"/>
      <p>Note that Installjammer is the open source software we have used to produce the installer.</p>
      <p>Click "Next and you will see:</p>
      <img src="installdestination.jpg"/>
      <p>You can change the destination if you need to. Click on the "Browse" button
      to change the destination.</p>
      
      <p> The JDK version that we have detected is displayed on this screen</p>
      
      <p>Once you have selected the destination, click "Next" and you will see: </p>
      
      <img src="installprojects.jpg"/>
      
      <p> Again you can change the destination for the leJOS projects. It defaults to leJOSNXJProjects in the users
      home directory. On Windows 7 or Vista this is C:\Users\<i>user</i> and on XP it is C:\Documents and Settings\<i>user</i>.</p>
      
      <p>All the Java source in leJOS NXJ is issued as projects that can be opened in Eclipse and Netbeans.</p>
      
      <p>Once you have selected the projects destination, the installation will start. If you already
         have leJOS NXJ installed in the selected destination, you will see:</p>
         
      <img src="installprevious.jpg"/> 
      <p> Click next and the previous version will be uninstalled:</p>
      <img src="uninstallquestion.jpg"/>
      
      <p>Once you have confirmed that you want the old version uninstalled, you will see:</p>
      <img src="uninstalling.jpg"/>
      
      <p> and then: </p>
      
      <img src="uninstallcomplete.jpg"/>
      
      <p>After any previous version has been uninstalled, the installation of the new version starts and you see:</p>
      
      <img src="installcopying.jpg"/>
      
      <p>Check that the destination directories are correct and click "Next". You will see:</p>
      
      <img src="installing.jpg"/>
      
      <p> When the software installation is complete, you see:</p>
      
      <img src="installfinish.jpg"/>
      
      <p>When you click "Finish" the GUI version of the NXJ firmware flash utility will start and allow you to update the firmware
      on one of more NXTs. </p>
      
      <p>You will see:</p>

      <img src="nxjflashg.jpg"/>
      
      <p>Click "Start Program" and you will be asked:</p>
      
      <img src="nxjflashgconnected.jpg"/>
      
      <p>Click OK and you will be asked:</p>
      
      <img src="nxjflashgerase.jpg"/>
      
      <p>If you select "Yes" all current files on the NXT are erased. It is a good idea to select this
      as old .nxj files may not work with the new firmware.</p>
      
      <p> You will then see:</p>
      
      <img src="nxjflashgconnected.jpg"/>
      
      <p>Make sure that your NXT is connected to the PC by the USB cable and witched on. Then press "OK" and
      you should see some progess messages, such as:</p>
      
      <img src="nxjflashgprogress.jpg"/>
      
      <p>When your NXT has been updated, you will be asked:</p>
      
      <img src="nxjflashgagain.jpg"/>
      
      <p>If you have more NXTs to update, click "Yes". When you have finished click "No" and the flash utility will
      terminate and then the installer will terminate, and you are done.</p>
      
      <p> Skip to the section below on testing your installation.</p>
      
      <p> <a href="#top">Back to top</a> </p>
      <a id="7" name="7"></a>
      <h4>Manual installation</h4>
      <p> Skip this section  and go to &quot;Testing the Installation&quot; if you are using the GUI installer.</p>
      <a id="8" name="8"></a>
      <h5>Unzipping the release</h5>
      <p> Unzip the release to a folder such as c:\lejosbeta9. The zip file includes a directory called lejos_nxj, so your
          NXJ_HOME folder will be c:\lejosbeta9\lejos_nxj.</p>
      <a id="9" name="9"></a>
      <h5>Setting up environment variables</h5>
      <p>You need to set:</p>
      <table border="1">
        <tbody>
          <tr>
            <td><b>Variable</b></td>
            <td><b>Value</b></td>
            <td><b>Example</b></td>
          </tr>
          <tr>
            <td>NXJ_HOME</td>
            <td>The folder you installed leJOS NXJ into</td>
            <td>C:\lejosbeta9\lejos_nxj</td>
          </tr>
          <tr>
            <td>JAVA_HOME</td>
            <td>The folder  where you installed the JDK </td>
            <td>C:\Program Files\Java\jdk1.6.0_24</td>
          </tr>
          <tr>
            <td>PATH</td>
            <td>Add the bin folders for the JDK and leJOS</td>
            <td>C:\Program Files\Java\jdk1.6.0_24\bin;C:\lejosbeta9\lejos_nxj\bin;</td>
          </tr>
        </tbody>
      </table>
      <p>Note that you can set LEJOS_NXT_JAVA_HOME instead, if you do not want to change JAVA_HOME. The bin directory for the JDK may already be on your PATH.</p>
      <p>You can set these environment variables by going to Control Panel &gt; System &gt; Advanced &gt; Environment
      Variables and creating them or editing existing values. You can set them either as user or system variables 
      depending on whether you want leJOS NXJ to be available to all users or just the current user.
      </p>
      <a id="10" name="10"></a>
      <h5>Using a Command Window</h5>
      <p> You will need to run command-line commands to test your installation and optionally to flash the firmware. If you plan to use IDE such as Eclipse or Netbeans, 
      once you have installed your IDE, you should not need to use the command window any more.</p>
      <p> You can start a command window on Windows XP by Start &gt; Run and typing cmd. On Vista or Windows 7, type "Command Prompt".</p>
      <p>Type <code>set</code> to list environment variables and check they are all set up correctly.</p>
      <a id="11" name="11"></a>
      <h5>Flashing the Firmware</h5>
      <p>As leJOS NXJ is a firmware replacement, you will need to flash the firmware to your NXT. 
      Note that this will overwrite any existing firmware. If you have the standard LEGO firmware or other third-party firmware on your NXT, existing files will be lost.</p>
      <p> The 0.85 release increases the amount of flash memory used by the firmware and the startup menu, so the first time you flash this version of the firmware, existing leJOS NXJ files will be deleted.
      </p>
      <p>Make sure your NXT is attached to the PC by its USB cable, and switch it on by pressing the orange button.</p>
      <p>You can either use the command line <code>nxjflash</code> command or the <code>nxjflashg</code> GUI program.</p>
      <p>Using the command line:</p>
      <p>Type <code>nxjflash</code> to flash the leJOS NXJ firmware. If your NXT is in firmware update mode, the firmware will be updated. 
      You will see some messages on your command window, and the NXT should show the leJOS splash screen and then the leJOS NXJ menu.
      If your NXT has a previous version of the leJOS or LEGO firmware on it, a list of the NXTs connected to the USB will be shown, 
      and you will be asked to input the number in the list of the NXT you want updated - this will be 1 if a single NXT is connected to your PC. 
      If your NXT has other firmware on it, or if <code>nxjflash</code> fails, you must put your NXT into firmware update mode. 
      Press the reset button (at the back of the NXT , upper left corner) for more than 4 seconds. 
      A straightened paper clip could be useful for this. Your NXT will audibly tick when it is firmware update mode. 
      Then try <code>nxjflash</code> again.
      </p>
      <p>Using the GUI version:</p>
      <p>The GUI version of nxjflash is NXJFlashG. You start it by running the file nxjflashg.bat from the leJOS NXJ bin folder. When the
      program window opens, click on Start Program and follow the instructions. 
      A more complete explanation is in the tutorial "PC GUI Tools".
      </p>
      <p> <a href="#top">Back to top</a> </p>
      <a id="12" name="12"></a>
      <h4>Testing your Installation</h4>
      <p> You can check that you have successfully installed leJOS NXJ on your PC and your NXT by compiling and running your first program.</p>
      <a id="13" name="13"></a>
      <h5>Compiling and running your first program</h5>
      <p> Java programs need to be compiled to class files before they
      can be run. For leJOS NXJ, all the class files that are to be run on
      the NXT needed to be linked to produce a binary file (with the
      extension .nxj) and this must then be uploaded to the NXT. 
      </p>
      <p> To run a sample program, such as the View.java sample, follow these steps: </p>
      <p> Start a command window, and change directory to the View sample folder: </p>
      <pre><code> cd leJOSNXJProjects\samples\View </code></pre>
      <p> Compile the program with the nxjc command: </p>
      <pre><code> nxjc View.java </code></pre>
      <p> Then link, upload and run it with the nxj command: </p>
      <pre><code> nxj -r View </code></pre>
      <p> You should see the menu of the View sample on your NXT. </p>
      <p> <a href="#top">Back to top</a> </p>
      <div class="NavBit"> <a target="_top" href="../Preliminaries/Intro.htm">«&nbsp;Previous</a>&nbsp;&#8226;&nbsp;
      <a href="../index.htm">TOC</a>&nbsp;&#8226;&nbsp;<a href="../Preliminaries/FirstProgram.htm">Next&nbsp;»</a> </div>
      <br />
      </td>
      <td> <br />
      </td>
    </tr>
  </tbody>
</table>
</body>
</html>