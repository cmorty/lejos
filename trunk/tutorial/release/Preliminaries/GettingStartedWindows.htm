<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		
  <title>Getting Started on Microsoft Windows</title>
  <!-- CSS -->
  <link rel="stylesheet" href="../r_css/lejos-tutorial.css" type="text/css" /><!-- ICONO -->
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
</head>
<body>
<a id="top" name="top"></a>
<!-- N1: HEADER -->
<table class="n1t1" cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td><img src="../r_media/images/tutorial_header1.jpg" /></td>
      <td align="right"><img src="../r_media/images/tutorial_header2.jpg" /></td>
    </tr>
  </tbody>
</table>
<!-- N2: CONTENTS -> NAVIGATION SYSTEMS AND CONTENTS -->
<table class="n2t1" cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td class="n2t1r1c1">
      <div class="nolinkLESSON">Getting Started on Microsoft Windows</div>
      <div class="linkAHEAD"><a href="#1">Prerequisites</a></div>
      <div class="linkAHEAD2"><a href="#2">Java Development Kit</a></div>
      <div class="linkAHEAD2"><a href="#3">USB Driver</a></div>
      <div class="linkAHEAD2"><a href="#4">Bluetooth Stack</a></div>
      <div class="linkAHEAD"><a href="#5">Downloading the software</a></div>
      <div class="linkAHEAD"><a href="#6">Running the GUI Installer</a></div>
      <div class="linkAHEAD"><a href="#7">Manual installation</a></div>
      <div class="linkAHEAD2"><a href="#8">Unzipping the release</a></div>
      <div class="linkAHEAD2"><a href="#9">Setting up environment variables</a></div>
      <div class="linkAHEAD2"><a href="#10">Using a Command Window</a></div>
      <div class="linkAHEAD2"><a href="#11">Flashing the firmware</a></div>
      <div class="linkAHEAD"><a href="#12">Testing your Installation</a></div>
      </td>
      <td>
        <div id="BreadCrumbs">
            <a href="../index.htm" target="_top">Home Page</a>&gt;
            <a href="#">Getting Started on Microsoft Windows</a>
        </div>
      <div class="NavBit"> <a target="_top" href="../Preliminaries/Intro.htm">«&nbsp;Previous</a>&nbsp;&#8226;&nbsp;
      <a href="../index.htm">TOC</a>&nbsp;&#8226;&nbsp;<a href="../Preliminaries/FirstProgram.htm">Next&nbsp;»</a> </div>
      <div id="PageTitle">Getting Started on Microsoft Windows</div>
      <p>This version of the tutorial is for the 0.9 release of leJOS NXJ. </p>
      
      <a id="1" name="1"></a>
      <h4>Prerequisites</h4>
      
      <a id="2" name="2"></a>
      <h5>Java Development Kit</h5>     
      <p>You will also need a Java Development Kit (JDK) on your PC. 
      Note that a Java Runtime Environment (JRE) is not sufficient 
      as it does not allow you to compile Java programs. You can download
      the latest JDK from <a href="http://www.oracle.com/technetwork/java/javase/downloads/" target="_blank">http://www.oracle.com/technetwork/java/javase/downloads/</a>.
      Follow the instructions for installing it. leJOS NXJ has been
      tested with JDK versions 1.5, 1.6, and 1.7, and will not work with earlier
      versions. JDK 1.6 or 1.7 is recommended.</p>
      <p>leJOS NXJ only works with 32-bit version of the JDK and JRE, so even if you have a 64-bit system,
      you should select a 32-bit version of the JDK.</p>
      
      <a id="3" name="3"></a>
      <h5>USB Driver</h5>     
      <p>To run leJOS NXJ on Microsoft Windows you will need a suitable USB driver on your PC. 
      If you have installed the standard LEGO Mindstorms NXT-G software, a suitable driver (the so-called Fantom driver) is already installed. 
      If you do not wish to install the LEGO software on your PC or if you want to update the Fantom driver to the latest version,
      you can get an installer from <a href="http://mindstorms.lego.com/en-us/support/files/Driver.aspx" target="_blank">The LEGO Mindstorms site</a>.
      </p>
      <p>It has come to our attention, that NXT-G as well as the Fantom driver don't install under Windows 7 Starter Edition.
      This can be worked around by adding a line to the setup.ini file.
      <a href="http://digital.ni.com/public.nsf/allkb/1817F501D7BA67F28625768F0000B260">Here</a> you find the official instructions
      by National Instruments, the authors of NXT-G and the Fantom driver. In short, you have to add <code>AllowWindowsStarter=1</code>
      to the [OS]-section of the setup.ini file.</p>

      <a id="4" name="4"></a>
      <h5>Bluetooth Stack</h5> 
      <p> If you want to communicate with the NXT over Bluetooth, you will need a Bluetooth dongle or built-in support on your PC, 
      and a Bluetooth software stack. leJOS NXJ has been tested with the Microsoft and Widcomm stacks, but might also work with others. 
      Bluesoleil is known to cause problems. You can use leJOS NXJ without Bluetooth.</p>
      <p><a href="#top">Back to top</a></p>
      
      <a id="5" name="5"></a>
      <h4>Downloading the software</h4> 
      <p>You can download the leJOS NXJ software from <a href="http://lejos.sourceforge.net/nxj-downloads.php" target="_blank">
      The leJOS NXJ download page</a>.</p>
      <p>It is recommended that you use the Windows installer, but there is a ZIP file release that you can use if you prefer to do a manual installation.</p>
      <p> <a href="#top">Back to top</a> </p>
      <a id="6" name="6"></a>
      
      
      <h4>Running the GUI installer</h4>
      <p>Download <code>leJOS_NXJ_0.9.1beta_win32_setup.exe</code>.
      Note that Inno Setup is the open source software we have used to produce the installer.
      Run the installer and you will see the following screen:
      </p>
      <img src="install01welcome.png"/>
      <p>Click "Next". Note, that at this point the installer will check whether the installed
      fantom driver is up-to-date. The installer will report an error if that is not the case
      and you can chose whether the open the <a href="http://mindstorms.lego.com/en-us/support/files/Driver.aspx"
      target="_blank">Fantom driver download page</a> or to continue without installing or updating
      the Fantom driver. In the latter case, USB communication with the NXT might not work properly.
      If the installation continues, you will see the next page of the installer:</p>
      <img src="install02jdk.png"/>
      <p>This page asks you to select the root folder of a 32 Bit Java Development Kit (JDK).
      You cannot continue the installation process without doing so. If none is installed,
      click the Download JDK button, download and installa a 32 Bit JDK and restart the installer.
      The selected folder will be assigned to the <em>LEJOS_NXT_JAVA_HOME</em> environment variable
      automatically at the end of the installation process.</p>
      <p>The next step is to select the destination directory, in which leJOS will be installed:</p>
      <img src="install03dir.png"/>
      <p>You can change the destination if you need to. Click on the "Browse" button
      to change the destination. On the next page, you can chose which components to install:</p>
      <img src="install04comp.png"/>
      <p>It is usually not necessary to modify these. However, you may chose to omit the documentation
      (it is also available online) or you may chose to install any of the additional sources.
      The Sample and Example Projects are also contained in the <em>samples.zip</em> that is part
      of the leJOS Development Kit. The Sources of the leJOS Development Kit can be used
      to modify and rebuild leJOS it self. It is usually not needed, if you only plan on
      developing programs based on leJOS and do not plan to modify components of leJOS itself.
      All additional sources are also available as a seperate download.
      If any additional sources have been selected, the destination directories for them
      can be changed on the next page.</p>
      <img src="install05dirs.png"/>
      <p>Note, that this page is skipped if no additional sources have been selected.
      The next page allows to adjust the folder in the start menu, that the leJOS
      shortcuts will be installed to:</p>
      <img src="install06menu.png"/>
      <p>The next page shows a summary of your choices:</p>
      <img src="install07summary.png"/>
      <p>The installation will start, if you click "Install". Note, that at this point
      the installer checks for any previous installs of leJOS. If any are found,
      their uninstaller is started. You cannot proceed with the installation
      without uninstalling the previous version.</p>
      <img src="install08progress.png"/>
      <p>After the installation complete, the following page will appear:</p>
      <img src="install09finish.png"/>
      <p>Uncheck "Launch NXJ Flash utility" if you don't want to start the graphical
      version of nxjflash, which allows you to upload the leJOS firmware onto the NXT
      brick. The leJOS firmware is needed to run any Java programs on the NXT. So it is
      recommened to run nxjflash. Note, that it is possible to revert to the original
      Lego firmware later.</p>
      
      <p>If you chose to NXJ Flash, you will see:</p>

      <img src="nxjflashg.jpg"/>
      
      <p>Click "Start Program" and you will be asked:</p>
      
      <img src="nxjflashgconnected.jpg"/>
      
      <p>Click OK and you will be asked:</p>
      
      <img src="nxjflashgerase.jpg"/>
      
      <p>If you select "Yes" all current files on the NXT are erased. It is a good idea to select this
      as old .nxj files may not work with the new firmware.</p>
      
      <p> You will then see:</p>
      
      <img src="nxjflashgconnected.jpg"/>
      
      <p>Make sure that your NXT is connected to the PC by the USB cable and witched on. Then press "OK" and
      you should see some progess messages, such as:</p>
      
      <img src="nxjflashgprogress.jpg"/>
      
      <p>When your NXT has been updated, you will be asked:</p>
      
      <img src="nxjflashgagain.jpg"/>
      
      <p>If you have more NXTs to update, click "Yes". When you have finished click "No" and the flash utility will
      terminate and then the installer will terminate, and you are done.</p>
      
      <p> Skip to the section below on testing your installation.</p>
      
      <p> <a href="#top">Back to top</a> </p>
      <a id="7" name="7"></a>
      
      
      <h4>Manual installation</h4>
      <p>If you have been using the GUI installer, skip this section and go to &quot;Testing the Installation&quot;.
      This section described the manual install without the GUI installer.</p>
      
      <a id="8" name="8"></a>
      <h5>Downloading and Unzipping</h5>
      <p>Download the file called <code>leJOS_NXJ_0.9.1beta_win32.zip</code> and unzip it to a location of
      your choice such as c:\lejos. The zip file includes a directory called leJOS_NXJ_0.9.1beta_win32,
      the leJOS Development Kit will reside inside the folder C:\lejos\leJOS_NXJ_0.9.1beta_win32.
      This will be the value for the NXJ_HOME environment variable (see below).</p>
      
      <a id="9" name="9"></a>
      <h5>Setting up environment variables</h5>
      <p>leJOS NXJ needs to know the locations of java.exe and javac.exe. There are several possibilities
      to achieve that: (1) add the bin directory of the JDK to your <em>PATH</em> environment variable
      so that commands such as <code>java</code> and <code>javac</code> can be called from a command prompt
      or (2) set the <em>LEJOS_NXT_JAVA_HOME</em> environment variable to the directory of an installed JDK.
      Note that you can use <em>JAVA_HOME</em> instead of LEJOS_NXT_JAVA_HOME, however setting JAVA_HOME might
      intefere with other applications.</p>
      
      <p>Examples:</p>
      <table border="1">
        <tbody>
          <tr>
            <td><b>Variable</b></td>
            <td><b>Value</b></td>
            <td><b>Examples</b></td>
          </tr>
          <tr>
            <td>NXJ_HOME</td>
            <td>The folder you installed leJOS NXJ into</td>
            <td>C:\lejos\leJOS_NXJ_0.9.1beta_win32</td>
          </tr>
          <tr>
            <td>LEJOS_NXT_JAVA_HOME</td>
            <td>The folder where you installed the 32 Bit JDK </td>
            <td>C:\Program Files\Java\jdk1.7.0_02<br/>
            C:\Program Files (x86)\Java\jdk1.7.0_02</td>
          </tr>
          <tr>
            <td>PATH</td>
            <td>Prepend the bin of the leJOS Development Kit</td>
            <td>C:\lejos\leJOS_NXJ_0.9.1beta_win32\bin;%PATH%</td>
          </tr>
        </tbody>
      </table>
      
      <p>The Windows installer will automatically sets all three
      environment variables for you. Setting them manually is only required during manual installation.
      You can set these environment variables manually by going to Control Panel &gt; System &gt; Advanced &gt; Environment
      Variables and creating them or editing existing values. You can set them either as user or system variables 
      depending on whether you want leJOS NXJ to be available to all users or just the current user.</p>
      
      <a id="10" name="10"></a>
      <h5>Using a Command Window</h5>
      <p>You will need to run command-line commands to test your installation and optionally to flash the firmware. If you plan to use IDE such as Eclipse or Netbeans, 
      once you have installed your IDE, you should not need to use the command window any more.</p>
      <p> You can start a command window on Windows XP by Start &gt; Run and typing cmd. On Vista or Windows 7, type "Command Prompt".</p>
      <p>Type <code>set</code> to list environment variables and check they are all set up correctly.</p>
      
      <a id="11" name="11"></a>
      <h5>Flashing the Firmware</h5>
      <p>As leJOS NXJ is a firmware replacement, you will need to flash the firmware to your NXT. 
      Note that this will overwrite any existing firmware. If you have the standard LEGO firmware or other third-party firmware on your NXT, existing files will be lost.
      However, it is possible to revert to the original Lego firmware either by using the
      Software provided by Lego or by using nxjflash.</p>
      <p>The 0.9.0 release increases the amount of flash memory used by the firmware and the startup menu,
      so the first time you flash this version of the firmware, existing leJOS NXJ files will be deleted.</p>
      <p>Make sure your NXT is attached to the PC via USB cable and switch it on by pressing the orange button.
      Open a command line prompt (as described above) and either type the command
      <code>nxjflash</code> or <code>nxjflashg</code> followed by hitting the Enter key.
      The latter starts the GUI version of nxjflash.</p> 
      
      <p>If you chose <code>nxjflash</code> to flash the leJOS NXJ firmware, you will see
      some messages on your command window.
      If the NXT brick is already in firmware update mode (it makes a ticking noise), then
      the firmware will be uploaded immediately. Otherwise, if your NXT has a previous version of
      the leJOS or LEGO firmware on it, a list of the NXTs connected to the USB will be shown 
      and you will be asked to input the number in the list of the NXT you want updated - this will
      be 1 if a single NXT is connected to your PC. After the flashing procedure has finished, you
      should see the leJOS logo on your NXT and hear the leJOS startup sound.
      If your NXT has other firmware on it, or if <code>nxjflash</code> fails, you must manually
      put your NXT into firmware update mode. Press the reset button (at the back of the NXT,
      hidden in the hole near the USB port) for more than 4 seconds. A straightened paper clip could
      be useful for this. Your NXT will audibly tick when it is firmware update mode. 
      Then try <code>nxjflash</code> again.</p>
      
      <p>Note that at the time of writing, the LEGO firmware has serious problems with talking
      to a computer running Linux via USB. Therefore it is recommened to manually put the NXT brick
      in firmware update mode as described above. The leJOS firmware does not have any problems
      of that kind.</p>
      
      <p>If you chose <code>nxjflashg</code>, the GUI version of nxjflash will start.
      Instead of typing the command on the command line, you can also double click nxjflashg.bat
      in the bin folder of the leJOS Development Kit. When the program window opens,
      click on Start Program and follow the instructions. 
      A more complete explanation is in the <a href="../PC_GUI/PCGUITools.htm">PC GUI Tools</a>
      tutorial page.</p>
      
      <p> <a href="#top">Back to top</a> </p>
      
      <a id="12" name="12"></a>
      <h4>Testing your Installation</h4>
      <p>You can test your installation by following the steps for writing your first leJOS Program
      which are the <a href="../Preliminaries/FirstProgram.htm">next part</a> of this tutorial.</p>
      
      <p> <a href="#top">Back to top</a> </p>
      <div class="NavBit"> <a target="_top" href="../Preliminaries/Intro.htm">«&nbsp;Previous</a>&nbsp;&#8226;&nbsp;
      <a href="../index.htm">TOC</a>&nbsp;&#8226;&nbsp;<a href="../Preliminaries/FirstProgram.htm">Next&nbsp;»</a> </div>
      <br />
      </td>
      <td> <br />
      </td>
    </tr>
  </tbody>
</table>
</body>
</html>