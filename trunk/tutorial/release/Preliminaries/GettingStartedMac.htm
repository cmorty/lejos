<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <title>Getting Started on OSX</title>
  <!-- CSS -->
  <link rel="stylesheet" href="../r_css/lejos-tutorial.css" type="text/css" /><!-- ICONO -->
  <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon" />
</head>
<body>
<a id="top" name="top"></a>
<!-- N1: HEADER -->
<table class="n1t1" cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td><img src="../r_media/images/tutorial_header1.jpg" /></td>
      <td align="right"><img src="../r_media/images/tutorial_header2.jpg" /></td>
    </tr>
  </tbody>
</table>
<!-- N2: CONTENTS -> NAVIGATION SYSTEMS AND CONTENTS -->
<table class="n2t1" cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td class="n2t1r1c1">
      <div class="nolinkLESSON">Getting Started on OSX</div>
      <div class="linkAHEAD"><a href="#1">Prerequisites</a></div>
      <div class="linkAHEAD2"><a href="#2">Standard Lego Software</a></div>
      <div class="linkAHEAD2"><a href="#3">Java Development Kit</a></div>
      <div class="linkAHEAD2"><a href="#4">Bluetooth Stack</a></div>
      <div class="linkAHEAD"><a href="#5">Downloading and Untarring the Software</a></div>
      <div class="linkAHEAD"><a href="#6">Setting up the Environment</a></div>
      <div class="linkAHEAD"><a href="#7">Setting Permissions</a></div>
      <div class="linkAHEAD"><a href="#8"></a>Configuring USB</div>
      <div class="linkAHEAD2"><a href="#9">(Optional) Testing with nxjbrowse</a></div>
      <div class="linkAHEAD2"><a href="#10">Flashing the Firmware</a></div>
      </td>
      <td>
        <div id="BreadCrumbs">
            <a href="../index.htm" target="_top">Home Page</a>&gt;
            <a href="#">Getting Started on OSX</a>
        </div>
      <div class="NavBit"> <a target="_top" href="../Preliminaries/Intro.htm">«&nbsp;Previous</a>&nbsp;&#8226;&nbsp;
      <a href="../index.htm">TOC</a>&nbsp;&#8226;&nbsp;<a href="../Preliminaries/CompileAndRun.htm">Next&nbsp;»</a> </div>
      <div id="PageTitle">Getting Started on OSX</div>
      <!--  
    
 
 

5. 
6. Now you need to tell leJOS to use this driver so edit/create a
nxj.properties file located in the lejos bin directory and add the
line...

NXTCommUSB=lejos.pc.comm.NXTCommFantom

Please take care to ensure that there are no extra spaces around any
of the above, no space after the "=" or at the end of the line...
7. 
8. If this works flash the 0.9 firmware with nxjflash
9. Let us know how it went...
-->
      <p>This version of the tutorial is for the 0.9 release of leJOS NXJ and is compatible with OSX10.4 or higher and both intel and ppc processors.</p>
      <a id="1" name="1"></a>
      <h4>Prerequisites</h4>
      <a id="2" name="2"></a>
      <h5>Standard Lego Software</h5>     
      <p> To run leJOS NXJ on OSX you will need the standard Lego software installed so that you can connect to your nxt using USB. It can be found here:
      <a href="http://mindstorms.lego.com/support/updates/" target="_blank"></a></p>
      <p>Note: Intel macs require the 10.5 update. This is true for OSX10.4 intel users as well. We have had several users report that this works... (the 10.5 update installer actually checks if your OS is 10.3+)</p>
      <a id="3" name="3"></a>
      <h5>Java Development Kit</h5>     
      <p>You will also need a Java Development Kit (JDK). 
      Note that a Java Runtime Environment (JRE) is not sufficient 
      as it does not allow you to compile Java programs. You can download
      the latest JDK from <a href="http://java.sun.com/" target="_blank">http://java.sun.com/</a>.
      Follow the instructions for installing it. The 32 bit version of Java is required and at this time only version 1.5 is 32 bit.</p>
      <a id="4" name="4"></a>
      <h5>Bluetooth Stack</h5> 
      <p> If you want to communicate with the NXT over Bluetooth, you will need a Bluetooth dongle or built-in support on your PC, 
      and a Bluetooth software stack. leJOS NXJ has been tested with the Microsoft and Widdcomm stacks, but should work with others. </p>
      <p> You can use leJOS NXJ without Bluetooth.</p>
      <p> <a href="#top">Back to top</a> </p>
      <a id="5" name="5"></a>
      <h4>Downloading and Untarring the Software</h4> 
      <p>You can download the leJOS NXJ software from <a href="http://lejos.sourceforge.net/nxj-downloads.php" target="_blank">
      The leJOS NXJ download page</a>.</p>
      <p>Un-tar the release (you do not need to run the build script)</p>
      <p> <a href="#top">Back to top</a> </p>
      <a id="6" name="6"></a>
      <h4>Setting up the Environment</h4>
      <h5>Environmental Variables</h5>
      <p>You need to set the following:  (Note: DYLD_LIBRARY_PATH is only necessary if you intend to use the Eclipse plugin)</p>
      <table border="1">
        <tbody>
          <tr>
            <td><b>Variable</b></td>
            <td><b>Value</b></td>
            <td><b>Example</b></td>
          </tr>
          <tr>
            <td>NXJ_HOME</td>
            <td>The folder you installed leJOS NXJ into</td>
            <td>/Users/me/lejos_nxj</td>
          </tr>
          <tr>
            <td>JAVA_HOME</td>
            <td>The folder where you installed the JDK </td>
            <td>/System/Library/Frameworks/JavaVM.framework/Versions/1.5.0/Home</td>
          </tr>
          <tr>
            <td>PATH</td>
            <td>Add the bin folders for the JDK and leJOS</td>
            <td>$JAVA_HOME/bin;$NXJ_HOME/bin;</td>
          </tr>
           <tr>
            <td>DYLD_LIBRARY_PATH</td>
            <td>Add the bin folder for leJOS so the Fantom driver library (libjfantom.jnilib) will be found</td>
            <td>$NXJ_HOME/bin;</td>
          </tr>
        </tbody>
      </table>
      
      <p>You can set these environment variables either as user or system variables 
      depending on whether you want leJOS NXJ to be available to just the current user or to all users.
      </p>
    <h5>Set Up for Current User</h5>
    <p>Create or Edit ~/.profile and set your environment there.<p>
    <p>If it does not exist, you can create it with TextEdit.  If it exists, you can open it from a command prompt:
    <code>
    $ open ~/.profile
    </code>
    Example:
    <code>
     export JAVA_HOME=/System/Library/Frameworks/JavaVM.framework/Versions/1.5.0/Home
	 export NXJ_HOME=/Users/me/lejos_nxj
     export DYLD_LIBRARY_PATH=$NXJ_HOME/bin
     export PATH=$PATH:$JAVA_HOME/bin:$NXJ_HOME/bin
    </code>
    </p>
    <h5>Set Up for All Users</h5>
    
    <p>Same as for Current User set up except use:</p>
    <code>cat /etc/profile</code>
    Example:
    <code>
    # System-wide .profile for sh(1)

     if [ -x /usr/libexec/path_helper ]; then
        eval `/usr/libexec/path_helper -s`
     fi

     if [ "${BASH-no}" != "no" ]; then
        [ -r /etc/bashrc ] && . /etc/bashrc
     fi
     ## setloginpath added /usr/local/bin start at Fri Nov  2 18:44:47 EDT 2007
     ## Do not remove the previous line
     if [ `whoami` != "root" ]
     then
       export JAVA_HOME="/System/Library/Frameworks/JavaVM.framework/Versions/1.5.0/Home"
       export NXJ_HOME="/Applications/lejos_nxj"
       export DYLD_LIBRARY_PATH="$NXJ_HOME/bin"
       PATH="$PATH:$NXJ_HOME/bin:$JAVA_HOME/bin"
       export PATH
     fi
     ## Do not remove the next line
     ## setloginpath added /usr/local/bin end at Fri Nov  2 18:44:47 EDT 2007 
    </code>  
    <p> <a href="#top">Back to top</a> </p>
     <a id="7" name="7"></a>
      <h5>Setting Permissions</h5>
      <p>Make the script files in the leJOS bin directory executable by cd'ing to that directory and executing the command.</p>
      <code>chmod +x *</code>
     <p> <a href="#top">Back to top</a> </p>     
       <a id="8" name="8"></a>
      <h5>Configuring USB</h5>
      <p>Create a nxj.properties file in $NXJ_HOME/bin containing NXTCommUSB=lejos.pc.comm.NXTCommFantom 
       <code>$ echo "NXTCommUSB=lejos.pc.comm.NXTCommFantom" > nxj.properties</code>  It is very important that there is no trailing space after NXTCommUSB=lejos.pc.comm.NXTCommFantom</p>
     <p> <a href="#top">Back to top</a> </p>   
       <a id="9" name="9"></a>
      <h5>(Optional) Testing with nxjbrowse</h5>
      <p>Test it by running <code>nxjbrowse -u</code> you should be able to see your NXT.</p>
       <p> <a href="#top">Back to top</a> </p>
      <a id="10" name="10"></a>
      <h5>Flashing the Firmware</h5>
      <p>As leJOS NXJ is a firmware replacement, you will need to flash the firmware to your NXT. 
      Note that this will overwrite any existing firmware. If you have a previous version of leJOS NXJ on your PC your existing files
      will be preserved, but if you have the standard LEGO firmware or other third-party firmware on your NXT, existing files will be lost.
      </p>
      <p>Make sure your NXT is attached to the PC by its USB cable, and switch it on by pressing the orange button.</p>
      <p>You can either use the command line <code>nxjflash</code> command or the <code>nxjflashg</code> GUI program.</p>
      <p>Using the command line:</p>
      <p>Type <code>nxjflash</code> to flash the leJOS NXJ firmware. If your NXT is in firmware update mode, the firmware will be updated. 
      You will see some messages on your command window, and the NXT should show the leJOS splash screen and then the leJOS NXJ menu.
      If your NXT has a previous version of the leJOS or LEGO firmware on it, a list of the NXTs connected to the USB will be shown, 
      and you will be asked to input the number in the list of the NXT you want updated - this will be 1 if a single NXT is connected to your PC. 
      If your NXT has other firmware on it, or if <code>nxjflash</code> fails, you must put your NXT into firmware update mode. 
      Press the reset button (at the back of the NXT , upper left corner) for more than 4 seconds. 
      A straightened paper clip could be useful for this. Your NXT will audibly tick when it is firmware update mode. 
      Then try <code>nxjflash</code> again.
      </p>
      <p>Using the GUI version:</p>
      <p>The GUI version of nxjflash is NXJFlashG. You start it by running the file nxjflashg from the leJOS NXJ bin folder. When the
      program window opens, click on Start Program and follow the instructions. 
      A more complete explanation is in the Windows tutorial "PC GUI Tools" section.  
      </p>
       
      <p> <a href="#top">Back to top</a> </p>
      <div class="NavBit"> <a target="_top" href="../Preliminaries/Intro.htm">«&nbsp;Previous</a>&nbsp;&#8226;&nbsp;
      <a href="../index.htm">TOC</a>&nbsp;&#8226;&nbsp;<a href="../Preliminaries/CompileAndRun.htm">Next&nbsp;»</a> </div>
      <br />
      </td>
      <td> <br />
      </td>
    </tr>
  </tbody>
</table>
</body>
</html>