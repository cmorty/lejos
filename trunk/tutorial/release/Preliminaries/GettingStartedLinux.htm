<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
  <title>Getting Started on Linux</title>
  <!-- CSS -->
  <link rel="stylesheet" href="../r_css/lejos-tutorial.css" type="text/css" /><!-- ICONO -->
  <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon" />
</head>
<body>
<a id="top" name="top"></a>
<!-- N1: HEADER -->
<table class="n1t1" cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td><img src="../r_media/images/tutorial_header1.jpg" /></td>
      <td align="right"><img src="../r_media/images/tutorial_header2.jpg" /></td>
    </tr>
  </tbody>
</table>
<!-- N2: CONTENTS -> NAVIGATION SYSTEMS AND CONTENTS -->
<table class="n2t1" cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td class="n2t1r1c1">
      <div class="nolinkLESSON">Getting Started on Linux</div>
      <div class="linkAHEAD"><a href="#1">Prerequisites</a></div>
      <div class="linkAHEAD2"><a href="#2">libusb</a></div>
      <div class="linkAHEAD2"><a href="#3">Java Development Kit</a></div>
      <div class="linkAHEAD2"><a href="#4">Package dependencies</a></div>
      <div class="linkAHEAD2"><a href="#5">Accessing USB Devices</a></div>
      <div class="linkAHEAD2"><a href="#6">Bluetooth Stack</a></div>
      <div class="linkAHEAD"><a href="#7">Downloading the software</a></div>
      <div class="linkAHEAD"><a href="#8">Installing the software</a></div>
      <div class="linkAHEAD2"><a href="#9">Unpacking the release</a></div>
      <div class="linkAHEAD2"><a href="#10">Setting up environment variables</a></div>
      <div class="linkAHEAD2"><a href="#11">Building the release</a></div>
      <div class="linkAHEAD2"><a href="#12">Flashing the firmware</a></div>
      <div class="linkAHEAD"><a href="#13">Testing your Installation</a></div>
      <div class="linkAHEAD2"><a href="#14">Compiling and running your first program</a></div>
      </td>
      <td>
        <div id="BreadCrumbs">
            <a href="../index.htm" target="_top">Home Page</a>&gt;
            <a href="#">Getting Started on Linux</a>
        </div>
      <div class="NavBit"> <a target="_top" href="../Preliminaries/Intro.htm">«&nbsp;Previous</a>&nbsp;&#8226;&nbsp;
      <a href="../index.htm">TOC</a>&nbsp;&#8226;&nbsp;<a href="../Preliminaries/FirstProgram.htm">Next&nbsp;»</a> </div>
      <div id="PageTitle">Getting Started on Linux</div>
      <p>This version of the tutorial is for the 0.85 release of leJOS NXJ. </p>
      <a id="1" name="1"></a>
      <h4>Prerequisites</h4>
      <a id="2" name="2"></a>
      <h5>libusb</h5>     
      <p>In order to use a USB connection to your NXT brick on Linux, you will need libusb installed on your sysyem. 
      leJOS requires the legacy 0.1.12 release. On most Linux distributions the 0.1.12 version of the libusb-devel  package will normally be installed. You can get more information from <a href="http://libusb.sourceforge.net">http://libusb.sourceforge.net</a></p>
      
      <a id="3" name="3"></a>
      <h5>Java Development Kit</h5>     
      <p>You will also need a Java Development Kit (JDK) on your PC. 
      Note that a Java Runtime Environment (JRE) is not sufficient 
      as it does not allow you to compile Java programs. You can download
      the latest JDK from <a href="http://java.sun.com/" target="_blank">http://java.sun.com/</a>.
      Follow the instructions for installing it. leJOS NXJ works has been
      tested with JDK versions 1.5 and 1.6, but will not work with earlier
      versions. JDK 1.6 is recommended as some PC samples do not work with JDK 1.5. Note that leJOS has only
      been tested with the official Sun JDK. </p>
      <p>You will need to add the JDK bin directory to your system or user PATH,
       so that commands such as <code>javac</code> and <code>java</code> can be called from a command prompt. If you do not know how to do this, 
       see the "Setting up environment variables" section below.</p>
       <p> It is also a good idea to set the environment variable JAVA_HOME to the folder where you installed the JDK, as it is necessary
           if you use the <code>ant</code> build system.</p>
      <a id="4" name="4"></a>
      <h5>Bluetooth Stack</h5> 
      <p> If you want to communicate with the NXT over Bluetooth, you will need a Linux supported Bluetooth dongle or built-in support on your PC. By
      default leJOS uses Bluecove with is included in the distribution, but there is an option to use the Linux BlueZ API directly.
       </p>
      <p> You can use leJOS NXJ without Bluetooth.</p>
      <p> <a href="#top">Back to top</a> </p>
      <a id="5" name="5"></a>
      <h4>Downloading the software</h4> 
      <p>You can download the leJOS NXJ software from <a href="http://lejos.sourceforge.net/nxj-downloads.php" target="_blank">
      The leJOS NXJ download page</a>.</p>
      <p>On Linux, leJOS is issues as a .tar.gz file.</p>
      <p> <a href="#top">Back to top</a> </p>
      <a id="6" name="6"></a>
      <h4>Installing leJOS</h4>
      <a id="8" name="8"></a>
      <h5>Unpacking the release</h5>
      <p> Unpack the release a directory of your choice.</p>
      <a id="9" name="9"></a>
      <h5>Setting up environment variables</h5>
      <p>You need to set:</p>
      <table border="1">
        <tbody>
          <tr>
            <td><b>Variable</b></td>
            <td><b>Value</b></td>
            <td><b>Example</b></td>
          </tr>
          <tr>
            <td>NXJ_HOME</td>
            <td>The folder you installed leJOS NXJ into</td>
            <td>/opt/leJOS0.85/</td>
          </tr>
          <tr>
            <td>JAVA_HOME</td>
            <td>The folder  where you installed the JDK </td>
            <td>/usr/java/</td>
          </tr>
          <tr>
            <td>PATH</td>
            <td>Add the bin folders for the JDK and leJOS</td>
            <td>$PATH:$JAVA_HOME/bin:$NXJ_HOME/bin</td>
          </tr>
        </tbody>
      </table>
      <p>Setting JAVA_HOME is not always  necessary, but is good practice. The bin directory for the JDK may already be on your PATH.</p>
      <p>With most Linux distributions, you can set these environment variables for the current user in .bash_profile or for all users in /etc/profile.
      If you use Eclipse and the Eclipse plugin, you will also need to add $NXJ_HOME/bin to LD_LIBRARY_PATH so that the Eclipse  plugin can access the leJOS NXJ JNI libraries. This should normally be done
      in /etc/profile, but this may  
      differ for specific Linux distributions.</p>
      <a id="10" name="10"></a>
      
      <h5>Flashing the Firmware</h5>
      <p>As leJOS NXJ is a firmware replacement, you will need to flash the firmware to your NXT. 
      Note that this will overwrite any existing firmware. If you have the standard LEGO firmware or other third-party firmware on your NXT, existing files will be lost.
      </p>
      <p>Note that the 0.85 release changes the amount of flash memory reserved for the firmware and the startup menu, so when you 
      first flash the 0.85 firmware any existing files will be lost </p>
      <p>Make sure your NXT is attached to the PC by its USB cable, and switch it on by pressing the orange button.</p>
      <p>You can either use the command line <code>nxjflash</code> command or the <code>nxjflashg</code> GUI program.</p>
      <p>Using the command line:</p>
      <p>Type <code>nxjflash</code> to flash the leJOS NXJ firmware. If your NXT is in firmware update mode, the firmware will be updated. 
      You will see some messages on your command window, and the NXT should show the leJOS splash screen and then the leJOS NXJ menu.
      If your NXT has a previous version of the leJOS or LEGO firmware on it, a list of the NXTs connected to the USB will be shown, 
      and you will be asked to input the number in the list of the NXT you want updated - this will be 1 if a single NXT is connected to your PC. 
      If your NXT has other firmware on it, or if <code>nxjflash</code> fails, you must put your NXT into firmware update mode. 
      Press the reset button (at the back of the NXT , upper left corner) for more than 4 seconds. 
      A straightened paper clip could be useful for this. Your NXT will audibly tick when it is firmware update mode. 
      Then try <code>nxjflash</code> again.
      </p>
      <p>Using the GUI version:</p>
      <p>The GUI version of nxjflash is NXJFlashG. You start it by running the file nxjflashg.bat from the leJOS NXJ bin folder. When the
      program window opens, click on Start Program and follow the instructions. 
      A more complete explanation is in the tutorial "PC GUI Tools".
      </p>
      <p> <a href="#top">Back to top</a> </p>
      <a id="12" name="12"></a>
      <h4>Testing your Installation</h4>
      <p> You can check that you have successfully installed leJOS NXJ on your PC and your NXT by compiling and running your first program.</p>
      <a id="13" name="13"></a>
      <h5>Compiling and running your first program</h5>
      <p> Java programs need to be compiled to class files before they
      can be run. For leJOS NXJ, all the class files that are to be run on
      the NXT needed to be linked to produce a binary file (with the
      extension .nxj) and this must then be uploaded to the NXT. 
      </p>
      <p> To run a sample program, such as the View.java sample, follow these steps: </p>
       Start a shell session, and change directory to the View sample folder: 
      <p> Compile the program with the nxjc command: </p>
      <pre><code> nxjc View.java </code></pre>
      <p> Then link, upload and run it with the nxj command: </p>
      <pre><code> nxj -r View </code></pre>
      <p> You should see the menu of the View sample on your NXT. </p>
      <p> <a href="#top">Back to top</a> </p>
      <div class="NavBit"> <a target="_top" href="../Preliminaries/Intro.htm">«&nbsp;Previous</a>&nbsp;&#8226;&nbsp;
      <a href="../index.htm">TOC</a>&nbsp;&#8226;&nbsp;<a href="../Preliminaries/FirstProgram.htm">Next&nbsp;»</a> </div>
      <br />
      </td>
      <td> <br />
      </td>
    </tr>
  </tbody>
</table>
</body>
</html>