<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>RegulateTest.java</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<style type="text/css">
<!--
body {color: #000000; background-color: #ffffff; font-family: Monospaced}
table {color: #000000; background-color: #e9e8e2; font-family: Monospaced}
.character {color: #0000ff}
.ST0 {color: #993300; font-family: Monospaced; font-weight: bold}
.comment {color: #339900}
.ST1 {color: #339900; font-family: Monospaced; font-weight: bold}
-->
</style>
</head>
<body>
<pre>
<span class="ST0">import</span> lejos.nxt.*;
<span class="ST0">import</span> lejos.util.*;

<span class="comment">/**</span> 
<span class="comment"> * </span><span class="comment">Test</span> <span class="comment">the</span> <span class="comment">accuracy</span> <span class="comment">of</span> <span class="comment">motor</span> <span class="comment">speed</span> <span class="comment">regulation</span><span class="comment">.</span>
<span class="comment"> * </span><span class="ST1">@author</span> <span class="comment">Roger</span>
 <span class="comment">*/</span>
<span class="ST0">public</span> <span class="ST0">class</span> RegulateTest
{
    Stopwatch sw = <span class="ST0">new</span> Stopwatch();
    Motor [] m = {Motor.A, Motor.B, Motor.C}; <span class="comment">//build an array of motors</span>
    
    <span class="comment">/**</span>
<span class="comment">     * </span><span class="comment">Display</span> <span class="comment">program</span> <span class="comment">name</span><span class="comment">, </span><span class="comment">wait</span> <span class="comment">for</span> <span class="comment">button</span><span class="comment">, </span><span class="comment">then</span> <span class="comment">call</span> <span class="comment">go</span><span class="comment">/</span>
<span class="comment">     * </span><span class="ST1">@param</span> <span class="comment">args</span>
     <span class="comment">*/</span>
    <span class="ST0">public</span> <span class="ST0">static</span> <span class="ST0">void</span> main( String[] args)
    {
        LCD.drawString(<span class="character">&quot;</span><span class="character"> Reg Test</span><span class="character">&quot;</span>, 0, 0);
        Button.waitForPress();
        LCD.clear();
        <span class="ST0">new</span> RegulateTest().go();   
    }
    <span class="comment">/**</span>
<span class="comment">     * </span><span class="comment">performs</span> <span class="comment">the</span> <span class="comment">test</span> <span class="comment">twice</span><span class="comment">,  </span><span class="comment">with</span> <span class="comment">and</span> <span class="comment">without</span> <span class="comment">speed</span> <span class="comment">regulation</span><span class="comment">.</span>
     <span class="comment">*/</span>
    <span class="ST0">public</span> <span class="ST0">void</span> go()
    {
        <span class="ST0">for</span>( <span class="ST0">int</span> i = 0; i&lt;3; i++)m[i].setSpeed(720);
        step();
       <span class="ST0">for</span>( <span class="ST0">int</span> i = 0; i&lt;3; i++)m[i].regulateSpeed(<span class="ST0">false</span>);
         step();      
    }
    <span class="comment">/**</span>
<span class="comment">     * </span><span class="comment">helper</span> <span class="comment">method</span><span class="comment"> - </span><span class="comment">does</span> <span class="comment">the</span> <span class="comment">detailed</span> <span class="comment">work</span><span class="comment">; </span><span class="comment">resets</span> <span class="comment">tacho</span> <span class="comment">count</span><span class="comment">, </span><span class="comment">runs</span> <span class="comment">motors</span><span class="comment">,</span>
<span class="comment">     * </span><span class="comment">displays</span> <span class="comment">data</span>
     <span class="comment">*/</span>
    <span class="ST0">public</span> <span class="ST0">void</span> step()
    {
        LCD.clear();
        sw.reset();  
        <span class="ST0">for</span>( <span class="ST0">int</span> i = 0; i&lt;3; i++)m[i].resetTachoCount();
        <span class="ST0">for</span>( <span class="ST0">int</span> i = 0; i&lt;3; i++)m[i].forward();
        <span class="ST0">for</span>(<span class="ST0">int</span> r = 0 ; r&lt;8; r++)
        {
            <span class="ST0">while</span>(sw.elapsed() &lt; 200* r)Thread.yield();
            <span class="ST0">for</span>( <span class="ST0">int</span> i = 0; i&lt;3; i++) 
            LCD.drawInt(m[i].getTachoCount(),5*i,r);            
        }
        <span class="ST0">for</span>( <span class="ST0">int</span> i = 0; i&lt;3; i++)m[i].stop();
        Button.waitForPress();       
    }
    
}


</pre></body>
</html>
