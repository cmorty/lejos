<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html dir="ltr" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"
 lang="en">
<head>
<!-- CSS -->
  <link rel="stylesheet" href="../r_css/lejos-tutorial.css"
 type="text/css">
<!-- ICON -->
  <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
  <title>Communications</title>
  <meta name="GENERATOR" content="OpenOffice.org 2.4  (Win32)">
  <meta name="AUTHOR" content="Roger">
  <meta name="CREATED" content="20080626;16090000">
  <meta name="CHANGED" content="20080819;19584545">
  <style type="text/css">
		<!--
			@page { size: 11.5in 11in; margin-left: 0.79in; margin-right: 1.75in; margin-top: 1in; margin-bottom: 1in }
			TD P { margin-bottom: 0.08in; direction: ltr; color: #000000; text-align: left; widows: 2; orphans: 2 }
			TD P.western { font-family: "Times New Roman", serif; font-size: 12pt; so-language: en-US }
			TD P.cjk { font-family: "Times New Roman", serif; font-size: 12pt; so-language: zxx }
			TD P.ctl { font-family: "Times New Roman", serif; font-size: 12pt; so-language: ar-SA }
			H1 { margin-bottom: 0.04in; direction: ltr; color: #ff6600; text-align: left; widows: 2; orphans: 2 }
			H1.western { font-family: "Arial", sans-serif; font-size: 16pt; so-language: en-US }
			H1.cjk { font-family: "Times New Roman", serif; font-size: 16pt; so-language: zxx }
			H1.ctl { font-family: "Arial", sans-serif; font-size: 16pt; so-language: ar-SA }
			P { margin-bottom: 0.08in; direction: ltr; color: #000000; text-align: left; widows: 2; orphans: 2 }
			P.western { font-family: "Times New Roman", serif; font-size: 12pt; so-language: en-US }
			P.cjk { font-family: "Times New Roman", serif; font-size: 12pt; so-language: zxx }
			P.ctl { font-family: "Times New Roman", serif; font-size: 12pt; so-language: ar-SA }
			H2 { margin-bottom: 0.08in; direction: ltr; color: #ff6600; text-align: left; widows: 2; orphans: 2 }
			H2.western { font-family: "Arial", sans-serif; font-size: 14pt; so-language: en-US; font-style: italic; font-weight: medium }
			H2.cjk { font-family: "Times New Roman", serif; font-size: 14pt; so-language: zxx; font-style: italic; font-weight: medium }
			H2.ctl { font-family: "Arial", sans-serif; font-size: 14pt; so-language: ar-SA; font-style: italic; font-weight: medium }
			H3 { margin-left: 0.2in; margin-bottom: 0.08in; direction: ltr; color: #ff6600; text-align: left; widows: 2; orphans: 2 }
			H3.western { font-family: "Arial", sans-serif; font-size: 13pt; so-language: en-GB; font-style: normal; font-weight: medium }
			H3.cjk { font-family: "Times New Roman", serif; font-size: 13pt; so-language: zxx; font-style: normal; font-weight: medium }
			H3.ctl { font-family: "Arial", sans-serif; font-size: 13pt; so-language: ar-SA; font-style: normal; font-weight: medium }
			H4 { margin-left: 0.3in; margin-bottom: 0.04in; direction: ltr; color: #000000; text-align: left; widows: 2; orphans: 2 }
			H4.western { font-family: "Arial", sans-serif; so-language: en-GB; font-style: normal }
			H4.cjk { font-family: "Times New Roman", serif; so-language: zxx; font-style: normal }
			H4.ctl { font-family: "Arial", sans-serif; so-language: ar-SA; font-style: italic; font-weight: medium }
			P.body-text-2-western { margin-left: 0.1in; font-family: "Times New Roman", serif; font-size: 12pt; so-language: en-US }
			P.body-text-2-cjk { margin-left: 0.1in; font-family: "Times New Roman", serif; font-size: 12pt; so-language: zxx }
			P.body-text-2-ctl { margin-left: 0.1in; font-family: "Times New Roman", serif; font-size: 12pt; so-language: ar-SA }
			P.body-text-3-western { margin-left: 0.2in; font-family: "Times New Roman", serif; font-size: 12pt; so-language: en-US }
			P.body-text-3-cjk { margin-left: 0.2in; font-family: "Times New Roman", serif; font-size: 12pt; so-language: zxx }
			P.body-text-3-ctl { margin-left: 0.2in; font-family: "Times New Roman", serif; font-size: 8pt; so-language: ar-SA }
			P.body-text-4-western { margin-left: 0.3in; font-family: "Times New Roman", serif; font-size: 12pt; so-language: en-US }
			P.body-text-4-cjk { margin-left: 0.3in; font-family: "Times New Roman", serif; font-size: 12pt; so-language: zxx }
			P.body-text-4-ctl { margin-left: 0.3in; font-family: "Times New Roman", serif; font-size: 8pt; so-language: ar-SA }
			P.close-western { margin-top: 0.02in; margin-bottom: 0.02in; font-family: "Courier New", monospace; font-size: 10pt; so-language: en-US }
			P.close-cjk { margin-top: 0.02in; margin-bottom: 0.02in; font-family: "Times New Roman", serif; font-size: 12pt; so-language: zxx }
			P.close-ctl { margin-top: 0.02in; margin-bottom: 0.02in; font-family: "Times New Roman", serif; font-size: 12pt; so-language: ar-SA }
			A:link { color: #0000ff }
			A:visited { color: #800080 }
		-->
		</style>
</head>
<body>
<a id="top" name="top"></a><!-- N1: HEADER -->
<table class="n1t1" cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td><img src="../r_media/images/tutorial_header1.jpg"></td>
      <td align="right"><img
 src="../r_media/images/tutorial_header2.jpg"></td>
    </tr>
  </tbody>
</table>
<!-- N2: CONTENTS -> NAVIGATION SYSTEMS AND CONTENTS -->
<table class="n2t1" cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td class="n2t1r1c1">
      <p class="western"><a href="#1.Communications%7Coutline"><font
 color="#0000ff"><u>Communications</u></font></a></p>
      <p class="western" style="margin-left: 0.33in;"><a
 href="#1.0.1.Receiver%7Coutline"><font color="#0000ff"><u>Receiver</u></font></a></p>
      <p class="western" style="margin-left: 0.33in;"><a
 href="#1.0.2.Streams%7Coutline"><font color="#0000ff"><u>Streams</u></font></a></p>
      <p class="western" style="margin-left: 0.33in;"><font
 color="#0000ff"><u><a href="#_NXT_Initiator">NXT Initiator</a></u></font></p>
      <p class="western" style="margin-left: 0.33in;"><a
 href="#1.0.4.PC%20Initiator%20%7Coutline"><font color="#0000ff"><u>PC
Initiator</u></font></a></p>
      <p class="western" style="margin-left: 0.5in;"><a
 href="#1.0.4.1.Bluetooth%20initiator%7Coutline"><font color="#0000ff"><u>Bluetooth
initiator</u></font></a></p>
      <p class="western" style="margin-left: 0.5in;"><font
 color="#0000ff"><u><a href="#_USB_initiator">USB </a><a
 href="#1.0.4.2.USB%20initiator%7Coutline">USB initiator</a></u></font></p>
      <p class="western"><a
 href="#1.0.4.3.Using%20the%20NXTInfo%20object%7Coutline"><font
 color="#0000ff"><u>Using the NXTInfo object</u></font></a></p>
      <p class="western" style="text-indent: 0.25in;"><font
 color="#0000ff"><u><a href="#2.Advanced%20Communications%7Coutline">Advanced
      </a><a href="#2.Advanced%20Communications%7Coutline">Advanced
Communications</a></u></font></p>
      <p class="western" style="text-indent: 0.25in;"><a
 href="#2.1.Controlling%20a%20remote%20NXT%7Coutline"><font
 color="#0000ff"><u>Controlling a remote NXT</u></font></a></p>
      <p class="western" style="text-indent: 0.25in;"><a
 href="#2.2.Communications%20External%20Bluetooth%20devices%7Coutline"><font
 color="#0000ff"><u>Communications External Bluetooth devices</u></font></a></p>
      <p class="western" style="text-indent: 0.25in;"><a
 href="#2.3.Communicating%20with%20the%20RCX%7Coutline"><font
 color="#0000ff"><u>Communicating with the RCX</u></font></a></p>
      </td>
      <td><!-- DO NOT MANINPULATE -->
      <div id="BreadCrumbs"> <a href="../index.htm" target="_top">Home
Page</a> &gt; <a href="#">Communications</a> </div>
      <div class="NavBit"> <a target="_top"
 href="../ErrorHandlingAndDebugging/ErrorHandling_and_debugging.htm">&laquo;&nbsp;Previous</a>&nbsp;&#8226;&nbsp;<a
 href="../index.htm">TOC</a>&nbsp;&#8226;&nbsp;<a
 href="../PC_GUI/PCGUITools.htm">Next&nbsp;&raquo;</a> </div>
<!-- CONTENT TITLE -->
      <div id="PageTitle">Communications</div>
      <a name="1.Communications|outline"></a>
      <p class="western">NXJ supports communications, by Bluetooth and
USB, The NXJ communications classes are designed so that most of your
code is independent of whether you are using Bluetooth or USB &#8211; you can
write applications that will use either one (See the example below.).
And you can use Java streams, which are a very flexible and easy to
use. </p>
      <p class="western">USB has the advantage of speed, but the cable
can be used only to connect a NXT to a PC. Bluetooth is slower, but
much flexible. It supports a multitude of methods of communicating NXT
to NXT, PC to NXT, Mobile phone to NXT, NXT to remote Bluetooth device,
etc. </p>
      <p class="western">The first step in communicating is to
establish a connection. A connection has an initiator and a receiver.
The receiver requests a connection from the initiator, and waits till
it has been established. Then both ends of the connection can use it to
supply input and output streams. The receiver program <b>only</b> runs
on a NXT. The initiator program may run on a PC (always for USB) , a
NXT, a mobile phone or another device that supports the Bluetooth
Serial Port Profile (SPP).</p>
      <h3 class="western" lang="en-GB"><a name="1.0.1.Receiver|outline"></a>
Receiver</h3>
      <p class="western">The receiver program on the NXT requests a
connection by calling the waitForConnection() method in the Bluetooth
or USB class as :</p>
      <ul>
        <li>
          <p class="western">BTConnection BTConnection
waitForConnection();</p>
        </li>
        <li>
          <p class="western">USBConnection USBConnection
waitForConnection();</p>
        </li>
      </ul>
      <p class="western" style="margin-left: 0.25in;">Even though the
Bluetooth class returns a BTconnection object, and the USB class
returns a USBConnection object, both of classes implement the
NXTConnectiion interface. So an object of either class can be assigned
to an reference variable that implements that interface. </p>
      <p class="western">BlueTooth Example:</p>
      <p class="close-western"><span id="Frame1" dir="ltr"
 style="border: 1px solid rgb(0, 0, 0); padding: 0.05in 0.1in; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; width: 5.05in; height: 0.38in; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
      <p class="close-western"><font color="#000000"><font
 face="Courier New, monospace"><font size="2">NXTConnection connection
= Bluetooth.</font></font></font><font color="#000000"><font
 face="Courier New, monospace"><font size="2"><i>waitForConnection</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">();</font></font></font></p>
      </span><br clear="left">
      <br>
      <br>
      </p>
      <p class="western">You need to ensure that Bluetooth power and
visibility are on before calling this method. The leJOS NXJ start-up
menu can be used to do this.</p>
      <p class="western"
 style="margin-bottom: 0in; widows: 0; orphans: 0;" align="left"> <font
 face="Times New Roman, serif"><font size="3">USB Example:</font></font></p>
      <p class="close-western"><span id="Frame2" dir="ltr"
 style="border: 1px solid rgb(0, 0, 0); padding: 0.05in 0.1in; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; width: 4.64in; height: 0.38in; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
      <p class="close-western"><font color="#000000"><font
 face="Courier New, monospace"><font size="2">NXTBConnection connection
= USB.</font></font></font><font color="#000000"><font
 face="Courier New, monospace"><font size="2"><i>waitForConnection</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">();</font></font></font></p>
      </span><br clear="left">
      <br>
      <br>
      </p>
      <p class="western">You need to ensure that the USB cable is
connected before calling this method.</p>
      <p class="western">Here is an example program that selects
between USB and Bluetooth at run time:</p>
      <p class="western"><span id="Frame3" dir="ltr"
 style="border: 1px solid rgb(0, 0, 0); padding: 0.05in 0.1in; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; width: 6.87in; height: 5.56in; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
      <p class="close-western"><font color="#993300"><font
 face="Monospaced, Times New Roman, serif"><b>import</b></font></font><font
 color="#000000"> lejos.nxt.*;</font></p>
      <p class="close-western"><font color="#993300"><font
 face="Monospaced, Times New Roman, serif"><b>import</b></font></font><font
 color="#000000"> lejos.nxt.comm.*;</font></p>
      <p class="close-western"><font color="#993300"><font
 face="Monospaced, Times New Roman, serif"><b>import</b></font></font><font
 color="#000000"> java.io.*;</font></p>
      <p class="close-western">/**</p>
      <p class="close-western">* sample of selecting channel at run time</p>
      <p class="close-western">*/</p>
      <p class="close-western"><font color="#993300"><font
 face="Monospaced, Times New Roman, serif"><b>public</b></font></font><font
 color="#000000"> </font><font color="#993300"><font
 face="Monospaced, Times New Roman, serif"><b>class</b></font></font><font
 color="#000000"> CommTest </font> </p>
      <p class="close-western">{</p>
      <p class="close-western" style="margin-left: 0.41in;"><font
 color="#993300"><font face="Monospaced, Times New Roman, serif"><b>public</b></font></font><font
 color="#000000"> </font><font color="#993300"><font
 face="Monospaced, Times New Roman, serif"><b>static</b></font></font><font
 color="#000000"> </font><font color="#993300"><font
 face="Monospaced, Times New Roman, serif"><b>void</b></font></font><font
 color="#000000"> main( String[] args)</font></p>
      <p class="close-western" style="margin-left: 0.41in;">{ </p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000">LCD.drawString(</font><font color="#0000ff">"right BT"</font><font
 color="#000000">,0, 0);</font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000">NXTConnection connection = </font><font
 color="#993300"><font face="Monospaced, Times New Roman, serif"><b>null</b></font></font><font
 color="#000000">;</font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#993300"><font face="Monospaced, Times New Roman, serif"><b>if</b></font></font><font
 color="#000000">( 4 == Button.waitForPress())</font></p>
      <p class="close-western" style="margin-left: 0.79in;">{</p>
      <p class="close-western" style="margin-left: 1.2in;"><font
 color="#000000">LCD.drawString(</font><font color="#0000ff">"waiting
for BT"</font><font color="#000000">, 0,1 );</font></p>
      <p class="close-western" style="margin-left: 1.2in;">connection =
Bluetooth.waitForConnection();</p>
      <p class="close-western" style="margin-left: 0.79in;">}</p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#993300"><font face="Monospaced, Times New Roman, serif"><b>else</b></font></font><font
 color="#000000"> </font> </p>
      <p class="close-western" style="margin-left: 0.79in;">{</p>
      <p class="close-western" style="margin-left: 1.2in;"><font
 color="#000000">LCD.drawString(</font><font color="#0000ff">"waiting
for USB"</font><font color="#000000">, 0,1 );</font></p>
      <p class="close-western" style="margin-left: 1.2in;">connection =
USB.waitForConnection();</p>
      <p class="close-western" style="margin-left: 0.79in;">}</p>
      <p class="close-western" style="margin-left: 0.79in;">DataOutputStream
dataOut = connection.openDataOutputStream();</p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#993300"><font face="Monospaced, Times New Roman, serif"><b>try</b></font></font><font
 color="#000000"> {dataOut.writeInt(1234);} </font> </p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#993300"><font face="Monospaced, Times New Roman, serif"><b>catch</b></font></font><font
 color="#000000"> (IOException e ) {System.out.println(</font><font
 color="#0000ff">" write error "</font><font color="#000000">+e);} </font>
      </p>
      <p class="close-western" style="margin-left: 0.41in;">}</p>
      <p class="close-western">}</p>
      </span><br clear="left">
      <br>
      <br>
      </p>
      <p class="western"><a href="#1.Communications%7Coutline"><font
 color="#0000ff"><u>Back to top</u></font></a></p>
      <h3 class="western" lang="en-GB"><a name="1.0.2.Streams|outline"></a>
Streams</h3>
      <p class="body-text-3-western">Once a connection has been
established, streams can then be opened by calling any of the following
methods in the NXTConnection interface:</p>
      <ul>
        <li>
          <p class="western">InputStream openInputStream() throws
IOException;</p>
        </li>
        <li>
          <p class="western">OutputStream openOutputStream() throws
IOException;</p>
        </li>
        <li>
          <p class="western">DataInputStream openDataInputStream()
throws IOException; (the example above did this) </p>
        </li>
        <li>
          <p class="western">DataOutputStream openDataOutputStream()
throws IOException;</p>
        </li>
      </ul>
      <p class="body-text-3-western">Data items can then be read from
the DataInputStream by:</p>
      <ul>
        <li>
          <p class="western">int read(byte b[]) throws IOException </p>
        </li>
        <li>
          <p class="western">int read(byte b[], int off, int len)
throws IOException</p>
        </li>
        <li>
          <p class="western">boolean readBoolean() throws IOException</p>
        </li>
        <li>
          <p class="western">byte readByte() throws IOException</p>
        </li>
        <li>
          <p class="western">short readShort() throws IOException</p>
        </li>
        <li>
          <p class="western">readInt() throws IOException</p>
        </li>
        <li>
          <p class="western">char readChar() throws IOException</p>
        </li>
        <li>
          <p class="western">float readFloat() throws IOException</p>
        </li>
        <li>
          <p class="western">String readLine() throws IOException</p>
        </li>
      </ul>
      <p class="body-text-2-western"><b>Be aware: </b>The stream read
methods are blocking &#8211; that is, they do not return until data is read.
If your program has other tasks that need attending to while waiting
for data, calls to the read methods should be made in a separate
thread. </p>
      <p class="body-text-2-western"><br>
      <br>
      </p>
      <p class="body-text-2-western">Data can be written to the
DataOutputStream by:</p>
      <ul>
        <li>
          <p class="western">void write(byte b[], int off, int len)
throws IOException</p>
        </li>
        <li>
          <p class="western">void writeBoolean(boolean v) throws
IOException</p>
        </li>
        <li>
          <p class="western">void writeByte(int v) throws IOException</p>
        </li>
        <li>
          <p class="western">void writeShort(int v) throws IOException</p>
        </li>
        <li>
          <p class="western">void writeChar(int v) throws IOException</p>
        </li>
        <li>
          <p class="western">void writeInt(int v) throws IOException</p>
        </li>
        <li>
          <p class="western">void writeFloat(float v) throws
IOException;</p>
        </li>
        <li>
          <p class="western">void writeChars (String value) throws
IOException</p>
        </li>
      </ul>
      <p class="body-text-2-western">Example. of reading and writing
integers using data streams (<font face="Courier New, monospace">dis a</font><font
 face="Times New Roman, serif">nd </font><font
 face="Courier New, monospace"> dos a</font><font
 face="Times New Roman, serif">re a DataInputStream and
DataOutputStream that has been opened)</font></p>
      <p class="body-text-2-western"><span id="Frame4" dir="ltr"
 style="border: 1px solid rgb(0, 0, 0); padding: 0.05in 0.1in; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; width: 3.88in; height: 1.49in; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
      <p class="close-western"><font color="#7f0055"><font
 face="Courier New, monospace"><font size="2"><b>for</b></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(</font></font></font><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>int</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">i=0;i&lt;100;i++) {</font></font></font></p>
      <p class="close-western" style="margin-left: 0.42in;"><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>int</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">n = dis.readInt();</font></font></font></p>
      <p class="close-western" style="margin-left: 0.42in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawInt</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(n,7,0,1);</font></font></font></p>
      <p class="close-western" style="margin-left: 0.42in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>refresh</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">();</font></font></font></p>
      <p class="close-western" style="margin-left: 0.42in;">dos.writeInt(-n);</p>
      <p class="close-western" style="margin-left: 0.42in;">dos.flush();</p>
      <p class="close-western">}</p>
      <p class="close-western"><br>
      </p>
      </span><br clear="left">
      <br>
      <br>
      </p>
      <p class="body-text-2-western"><b>Be aware: </b>you must flush
the output stream to be sure the data is actually transmitted.
Furthermore, it is possible for transmission to fail without throwing
an exception. </p>
      <p class="body-text-2-western">The DataInputStream,
DataOutputstream and NXTConnection can then be closed using the close()
method.</p>
      <p class="body-text-2-western"><br>
      <br>
      </p>
      <p class="body-text-2-western">The full example using BlueTooth
is:</p>
      <p class="close-western"><span id="Frame5" dir="ltr"
 style="border: 1px solid rgb(0, 0, 0); padding: 0.05in 0.1in; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; width: 6.66in; height: 6.61in; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
      <p class="close-western"><font color="#7f0055"><font
 face="Courier New, monospace"><font size="2"><b>public</b></font></font></font><font
 color="#000000"> </font><font color="#7f0055"><font
 face="Courier New, monospace"><font size="2"><b>class</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">BTReceive {</font></font></font></p>
      <p class="close-western"><br>
      <br>
      </p>
      <p class="close-western" style="margin-left: 0.42in;"><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>public</b></font></font></font><font
 color="#000000"> </font><font color="#7f0055"><font
 face="Courier New, monospace"><font size="2"><b>static</b></font></font></font><font
 color="#000000"> </font><font color="#7f0055"><font
 face="Courier New, monospace"><font size="2"><b>void</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">main(String [] args) </font></font></font><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>throws</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">Exception </font></font></font>
      </p>
      <p class="close-western" style="margin-left: 0.42in;">{</p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">String
connected = </font></font></font><font color="#2a00ff"><font
 face="Courier New, monospace"><font size="2">"Connected"</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">;</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">String
waiting = </font></font></font><font color="#2a00ff"><font
 face="Courier New, monospace"><font size="2">"Waiting..."</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">;</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">String
closing = </font></font></font><font color="#2a00ff"><font
 face="Courier New, monospace"><font size="2">"Closing..."</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">;</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>while</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">(</font></font></font><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>true</b></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">)</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;">{</p>
      <p class="close-western" style="margin-left: 1.18in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(waiting,0,0);</font></font></font></p>
      <p class="close-western" style="margin-left: 1.18in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">NXTConnection
connection = Bluetooth.</font></font></font><font color="#000000"><font
 face="Courier New, monospace"><font size="2"><i>waitForConnection</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">();</font></font></font>
      </p>
      <p class="close-western" style="margin-left: 1.18in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>clear</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">();</font></font></font></p>
      <p class="close-western" style="margin-left: 1.18in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(connected,0,0);</font></font></font></p>
      <p class="close-western" style="margin-left: 1.18in;">DataInputStream
dis = connection.openDataInputStream();</p>
      <p class="close-western" style="margin-left: 1.18in;">DataOutputStream
dos = connection.openDataOutputStream();</p>
      <p class="close-western" style="margin-left: 1.18in;"><br>
      <br>
      </p>
      <p class="close-western" style="margin-left: 1.18in;"><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>for</b></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(</font></font></font><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>int</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">i=0;i&lt;100;i++) {</font></font></font></p>
      <p class="close-western" style="margin-left: 1.58in;"><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>int</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">n = dis.readInt();</font></font></font></p>
      <p class="close-western" style="margin-left: 1.58in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><span
 lang="fr-FR">LCD.</span></font></font></font><font color="#000000"><font
 face="Courier New, monospace"><font size="2"><span lang="fr-FR"><i>drawInt</i></span></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><span
 lang="fr-FR">(n,7,0,1);</span></font></font></font></p>
      <p class="close-western" style="margin-left: 1.58in;">dos.writeInt(-n);</p>
      <p class="close-western" style="margin-left: 1.58in;">dos.flush();</p>
      <p class="close-western" style="margin-left: 1.18in;">}</p>
      <p class="close-western" style="margin-left: 1.18in;">dis.close();</p>
      <p class="close-western" style="margin-left: 1.18in;">dos.close();</p>
      <p class="close-western" style="margin-left: 1.18in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">Thread.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>sleep</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(100);
      </font></font></font><font color="#3f7f5f"><font
 face="Courier New, monospace"><font size="2">// wait for data to drain</font></font></font></p>
      <p class="close-western" style="margin-left: 1.18in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>clear</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">();</font></font></font></p>
      <p class="close-western" style="margin-left: 1.18in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(closing,0,0);</font></font></font></p>
      <p class="close-western" style="margin-left: 1.18in;">btc.close();</p>
      <p class="close-western" style="margin-left: 1.18in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>clear</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">();</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;">}</p>
      <p class="close-western" style="margin-left: 0.42in;">}</p>
      <p class="close-western">}</p>
      </span><br clear="left">
      <br>
      <br>
      </p>
      <p class="body-text-2-western">To modify this example to work
with USB, you only have to change Bluetooth.waitforconnection() to
USB.waitForconnectkon()</p>
      <p class="western"><br>
      <br>
      </p>
      <p class="western"><a href="#1.Communications%7Coutline"><font
 color="#0000ff"><u>Back to top</u></font></a></p>
      <p class="western"><br>
      <br>
      </p>
	  <a name="_NXT_Initiator"></a>
      <h3 class="western" lang="en-GB">NXT Initiator - Bluetooth</h3>
      <p class="body-text-2-western"><br>
      <br>
      </p>
      <p class="body-text-3-western">To initiate a Bluetooth connection
from one NXT to another NXT, you first need to add the receiver NXT to
the initiator NXT&#8217;s Bluetooth devices.</p>
      <p class="body-text-3-western">To do this, you go to the
Bluetooth menu in the leJOS NXJ start-up menu and select &#8220;Search&#8221;.
Providing the Bluetooth power is on and visibility is on for the
receiving NXT, it will be found and you can select &#8220;Add&#8221; to add it to
the initiator&#8217;s Bluetooth devices.</p>
      <p class="body-text-3-western">To check it is in the Devices
list, you can select &#8220;Devices&#8221; from the Bluetooth menu of the initiator
NXT.</p>
      <p class="body-text-3-western">You can then create a
BTRemoteDevice class on the initiator NXT:</p>
      <p class="body-text-3-western">Example:</p>
      <p class="close-western"><span id="Frame6" dir="ltr"
 style="border: 1px solid rgb(0, 0, 0); padding: 0.05in 0.1in; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; width: 5.59in; height: 0.45in; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
      <p class="close-western">BTRemoteDevice btrd =
Bluetooth.getKnownDevice(name);</p>
      </span><br clear="left">
      <br>
      <br>
      </p>
      <p class="body-text-3-western">You can connect to the remote
device by its address, which you can get by:</p>
      <ul>
        <li>
          <p class="western">public byte[] getDeviceAddr()</p>
        </li>
      </ul>
      <p class="body-text-3-western"><br>
      </p>
      <p class="body-text-3-western">You can then connect to the remote
device by calling one of the connect() methods in the Bluetooth class:</p>
      <ul>
        <li>
          <p class="western">BTConnection connect(BTRemoteDevice
remoteDevice)</p>
        </li>
      </ul>
      <ul>
        <li>
          <p class="western">BTConnection connect(byte[] device_addr)</p>
        </li>
        <li>
          <p class="western">BTConnection connect(byte[] device_addr,
byte[] pin)</p>
        </li>
      </ul>
      <p class="western">Example:</p>
      <p class="close-western"><span id="Frame7" dir="ltr"
 style="border: 1px solid rgb(0, 0, 0); padding: 0.05in 0.1in; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; width: 5.21in; height: 2.85in; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
      <p class="close-western"><font color="#000000"><font
 face="Courier New, monospace"><font size="2">BTRemoteDevice btrd =
Bluetooth.</font></font></font><font color="#000000"><font
 face="Courier New, monospace"><font size="2"><i>getKnownDevice</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(name);</font></font></font><br>
      <br>
      </p>
      <p class="close-western"><font color="#7f0055"><font
 face="Courier New, monospace"><font size="2"><b>if</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">(btrd == </font></font></font><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>null</b></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">) {</font></font></font></p>
      <p class="close-western" style="margin-left: 0.51in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>clear</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">();</font></font></font></p>
      <p class="close-western" style="margin-left: 0.51in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(</font></font></font><font
 color="#2a00ff"><font face="Courier New, monospace"><font size="2">"No
such device"</font></font></font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">, 0, 0);</font></font></font></p>
      <p class="close-western" style="margin-left: 0.51in;">Button.waitForPress();</p>
      <p class="close-western" style="margin-left: 0.51in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">System.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>exit</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(1);</font></font></font></p>
      <p class="close-western">}</p>
      <p class="close-western"><font color="#000000"><font
 face="Courier New, monospace"><font size="2">BTConnection btc =
Bluetooth.</font></font></font><font color="#000000"><font
 face="Courier New, monospace"><font size="2"><i>connect</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(btrd);</font></font></font></p>
      <p class="close-western"><font color="#7f0055"><font
 face="Courier New, monospace"><font size="2"><b>if</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">(btc == </font></font></font><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>null</b></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">) {</font></font></font></p>
      <p class="close-western" style="margin-left: 0.5in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>clear</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">();</font></font></font></p>
      <p class="close-western" style="margin-left: 0.5in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(</font></font></font><font
 color="#2a00ff"><font face="Courier New, monospace"><font size="2">"Connect
fail"</font></font></font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">, 0, 0);</font></font></font></p>
      <p class="close-western" style="margin-left: 0.5in;">Button.waitForPress();</p>
      <p class="close-western" style="margin-left: 0.5in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">System.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>exit</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(1);</font></font></font></p>
      <p class="close-western">}</p>
      </span><br clear="left">
      <br>
      <br>
      </p>
      <p class="body-text-3-western">Having got a BTconnection object
you can open the data input and output streams and read data as in the
receiver example above.</p>
      <p class="body-text-3-western">The complete BTConnectTest
example, which works as the initiator program for the BTReceive
receiver program, is:</p>
      <p class="western"><span id="Frame8" dir="ltr"
 style="border: 1px solid rgb(0, 0, 0); padding: 0.05in 0.1in; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; width: 5.79in; height: 9.26in; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
      <p class="close-western"><font color="#7f0055"><font
 face="Courier New, monospace"><font size="2"><b>public</b></font></font></font><font
 color="#000000"> </font><font color="#7f0055"><font
 face="Courier New, monospace"><font size="2"><b>class</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">BTConnectTest {</font></font></font></p>
      <p class="close-western" style="margin-left: 0.43in;"><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>public</b></font></font></font><font
 color="#000000"> </font><font color="#7f0055"><font
 face="Courier New, monospace"><font size="2"><b>static</b></font></font></font><font
 color="#000000"> </font><font color="#7f0055"><font
 face="Courier New, monospace"><font size="2"><b>void</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">main(String[] args) </font></font></font><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>throws</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">Exception {</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">String
name = </font></font></font><font color="#2a00ff"><font
 face="Courier New, monospace"><font size="2">"NXT"</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">;</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i><font
 color="#000000"><font face="Courier New, monospace"><font size="2">drawString</font></font></font></i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(</font></font></font></font></font></font><font
 color="#2a00ff"><font face="Courier New, monospace"><font size="2"><font
 color="#2a00ff"><font face="Courier New, monospace"><font size="2">"Connecting..."</font></font></font></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">,
0, 0);</font></font></font></font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">BTRemoteDevice
btrd = Bluetooth.</font></font></font><font color="#000000"><font
 face="Courier New, monospace"><font size="2"><i>getKnownDevice</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(name);</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>if</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">(btrd == </font></font></font><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>null</b></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">) {</font></font></font></p>
      <p class="close-western" style="margin-left: 1.19in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>clear</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">();</font></font></font></p>
      <p class="close-western" style="margin-left: 1.19in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(</font></font></font><font
 color="#2a00ff"><font face="Courier New, monospace"><font size="2">"No
such device"</font></font></font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">, 0, 0);</font></font></font></p>
      <p class="close-western" style="margin-left: 1.19in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">Thread.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>sleep</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(2000);</font></font></font></p>
      <p class="close-western" style="margin-left: 1.19in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">System.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>exit</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(1);</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;">}</p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">BTConnection
btc = Bluetooth.</font></font></font><font color="#000000"><font
 face="Courier New, monospace"><font size="2"><i>connect</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(btrd);</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>if</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">(btc == </font></font></font><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>null</b></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">) {</font></font></font></p>
      <p class="close-western" style="margin-left: 1.08in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>clear</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">();</font></font></font></p>
      <p class="close-western" style="margin-left: 1.08in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(</font></font></font><font
 color="#2a00ff"><font face="Courier New, monospace"><font size="2">"Connect
fail"</font></font></font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">, 0, 0);</font></font></font></p>
      <p class="close-western" style="margin-left: 1.08in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">Thread.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>sleep</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(2000);</font></font></font></p>
      <p class="close-western" style="margin-left: 1.08in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">System.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>exit</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(1);</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;">}</p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>clear</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">();</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(</font></font></font><font
 color="#2a00ff"><font face="Courier New, monospace"><font size="2">"Connected"</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">,
0, 0);</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;">DataInputStream
dis = btc.openDataInputStream();</p>
      <p class="close-western" style="margin-left: 0.79in;">DataOutputStream
dos = btc.openDataOutputStream();</p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>for</b></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(</font></font></font><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>int</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">i=0;i&lt;100;i++) {</font></font></font></p>
      <p class="close-western" style="margin-left: 1.13in;"><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>try</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">{</font></font></font></p>
      <p class="close-western" style="margin-left: 1.46in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawInt</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(i*30000,
8, 0, 2);</font></font></font></p>
      <p class="close-western" style="margin-left: 1.46in;">dos.writeInt(i*30000);</p>
      <p class="close-western" style="margin-left: 1.46in;">dos.flush();
      </p>
      <p class="close-western" style="margin-left: 1.46in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">} </font></font></font><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>catch</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">(IOException ioe) {</font></font></font></p>
      <p class="close-western" style="margin-left: 1.46in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(</font></font></font><font
 color="#2a00ff"><font face="Courier New, monospace"><font size="2">"Write
Exception"</font></font></font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">, 0, 0);</font></font></font></p>
      <p class="close-western" style="margin-left: 1.46in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>refresh</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">();</font></font></font></p>
      <p class="close-western" style="margin-left: 1.13in;">}</p>
      <p class="close-western" style="margin-left: 1.13in;"><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>try</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">{</font></font></font></p>
      <p class="close-western" style="margin-left: 1.33in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawInt</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(dis.readInt(),8,
0,3);</font></font></font></p>
      <p class="close-western" style="margin-left: 1.33in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">} </font></font></font><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>catch</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">(IOException ioe) {</font></font></font></p>
      <p class="close-western" style="margin-left: 1.33in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(</font></font></font><font
 color="#2a00ff"><font face="Courier New, monospace"><font size="2">"Read
Exception "</font></font></font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">, 0, 0);</font></font></font></p>
      <p class="close-western" style="margin-left: 1.13in;">}</p>
      <p class="close-western" style="margin-left: 0.79in;">}</p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>try</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">{</font></font></font></p>
      <p class="close-western" style="margin-left: 1.25in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(</font></font></font><font
 color="#2a00ff"><font face="Courier New, monospace"><font size="2">"Closing...
"</font></font></font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">, 0, 0);</font></font></font></p>
      <p class="close-western" style="margin-left: 1.25in;">dis.close();</p>
      <p class="close-western" style="margin-left: 1.25in;">dos.close();</p>
      <p class="close-western" style="margin-left: 1.25in;">btc.close();</p>
      <p class="close-western" style="margin-left: 1.25in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">} </font></font></font><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>catch</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">(IOException ioe) {</font></font></font></p>
      <p class="close-western" style="margin-left: 1.25in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(</font></font></font><font
 color="#2a00ff"><font face="Courier New, monospace"><font size="2">"Close
Exception"</font></font></font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">, 0, 0);</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;">}</p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(</font></font></font><font
 color="#2a00ff"><font face="Courier New, monospace"><font size="2">"Finished"</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">,3,
4);</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;">Button.waitForPress();</p>
      <p class="close-western" style="margin-left: 0.43in;">}</p>
      <p class="close-western">}</p>
      </span><br clear="left">
      <br>
      <br>
      </p>
      <p class="western" style="text-indent: 0.2in;"><a
 href="#_Communications"><font color="#0000ff"><u>Back to top</u></font></a></p>
      <p class="western"><br>
      <br>
      </p>
      <h3 class="western" lang="en-GB"><a
 name="1.0.4.PC Initiator |outline"></a> PC Initiator </h3>
      <p class="western"><br>
      <br>
      </p>
      <p class="body-text-3-western">A PC program can initiate a
connection to a NXT and open a Java data stream.</p>
      <p class="body-text-3-western">The API on the PC is different to
the NXT API. See pcapidocs.</p>
      <p class="body-text-3-western">To connect to the NXT, you need a
NXTComm object that can be obtained using the NXTCommFactory class:</p>
      <ul>
        <li>
          <p class="western">public static NXTComm createNXTComm(int
protocol)</p>
        </li>
      </ul>
      <h4 class="western" lang="en-GB"><a
 name="1.0.4.1.Bluetooth initiator|outline"></a> Bluetooth initiator</h4>
      <p class="body-text-4-western">Bluetooth Example:</p>
      <p class="western"><span id="Frame9" dir="ltr"
 style="border: 1px solid rgb(0, 0, 0); padding: 0.05in 0.1in; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; width: 5.7in; height: 0.26in; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
      <p class="close-western"><font color="#000000"><font
 face="Courier New, monospace"><font style="font-size: 9pt;" size="2">NXTComm
nxtComm = NXTCommFactory.</font></font></font><font color="#000000"><font
 face="Courier New, monospace"><font style="font-size: 9pt;" size="2"><i>createNXTComm</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font
 style="font-size: 9pt;" size="2">(NXTCommFactory.</font></font></font><font
 color="#0000c0"><font face="Courier New, monospace"><font
 style="font-size: 9pt;" size="2"><i>BLUETOOTH</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font
 style="font-size: 9pt;" size="2">);</font></font></font></p>
      </span><br clear="left">
      <br>
      <br>
      </p>
      <p class="body-text-4-western">The reason for using a factory
method is that there are several implementations of comms drivers for
Bluetooth and USB on the PC and the one that is used depends on what
operating system you are using and the contents of he nxj.properties
file.</p>
      <p class="body-text-4-western">You can connect to the NXT by
address or by do a Bluetooth inquiry:</p>
      <p class="body-text-4-western">To connect by address, you create
a NXTInfo object using the constructor:</p>
      <ul>
        <li>
          <p class="western">public NXTInfo(String name, String address)</p>
        </li>
      </ul>
      <p class="body-text-4-western">Example:</p>
      <p class="western"><span id="Frame10" dir="ltr"
 style="border: 1px solid rgb(0, 0, 0); padding: 0.05in 0.1in; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; width: 5.05in; height: 0.45in; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
      <p class="close-western">NXTInfo nxtInfo = new NXTInfo(&#8220;NXT&#8221;,
&#8220;00:16:53:00:78:48&#8221;);</p>
      </span><br clear="left">
      <br>
      <br>
      </p>
      <p class="body-text-4-western">To find the available NXTs doing a
Bluetooth inquiry, you do:</p>
      <ul>
        <li>
          <p class="western">NXTInfo[] nxtInfo = nxtComm.search(&#8220;NXT&#8221;,
NXTCommFactory.BLUETOOTH);</p>
        </li>
      </ul>
      <p class="body-text-4-western"><br>
      <br>
      </p>
      <p class="western"><br>
      <br>
      </p>
      <p class="western"><a href="#1.Communications%7Coutline"><font
 color="#0000ff"><u>Back to top</u></font></a></p>
      <p class="western"><br>
      <br>
      </p>
      <p class="body-text-4-western"><br>
      <br>
      </p>
      <h4 class="western" lang="en-GB"><a
 name="1.0.4.2.USB initiator|outline"></a> USB initiator</h4>
      <p class="body-text-4-western">The initiator sequence using USB
is almost the same as for Bluetooth; You just have to use USB instead
of Bluetooth.in your code. While USB cannot use a device address , but
you can use the NXT name. </p>
      <p class="western"><span id="Frame11" dir="ltr"
 style="border: 1px solid rgb(0, 0, 0); padding: 0.05in 0.1in; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; width: 6.14in; height: 0.26in; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
      <p class="close-western"><font color="#000000"><font
 face="Courier New, monospace"><font style="font-size: 9pt;" size="2">NXTComm
nxtComm = NXTCommFactory.</font></font></font><font color="#000000"><font
 face="Courier New, monospace"><font style="font-size: 9pt;" size="2"><i>createNXTComm</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font
 style="font-size: 9pt;" size="2">(NXTCommFactory.</font></font></font><font
 color="#0000c0"><font face="Courier New, monospace"><font
 style="font-size: 9pt;" size="2"><i>USB</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font
 style="font-size: 9pt;" size="2">);</font></font></font></p>
      </span><br clear="left">
      <br>
      <br>
      </p>
      <p class="body-text-4-western">To find the available NXT , you do:</p>
      <ul>
        <li>
          <p class="western">NXTInfo[] nxtInfo =
nxtComm.search(&#8220;MYNXT&#8221;, NXTCommFactory.BLUETOOTH);</p>
        </li>
      </ul>
      <p class="body-text-4-western">If there is only one NXT
connected, you can use a null name parameter in the search() method. </p>
      <p class="western"><br>
      <br>
      </p>
      <p class="western"><a href="#1.Communications%7Coutline"><font
 color="#0000ff"><u>Back to top</u></font></a></p>
      <p class="western"><br>
      <br>
      </p>
      <p class="western"><br>
      <br>
      </p>
      <h4 class="western" lang="en-GB"><a
 name="1.0.4.3.Using the NXTInfo object|outline"></a> Using the NXTInfo
object</h4>
      <p class="body-text-4-western">Once you have a NXTInfo object,
you can call the open() method of the NXTComm object to connect to the
NXT:</p>
      <ul>
        <li>
          <p class="western">public boolean open(NXTInfo nxt) throws
NXTCommException;</p>
        </li>
      </ul>
      <p class="body-text-4-western">Once the NXT is open, you can
obtain an InputStream and an OutputSttream, by calling the
getInputStream() anf getOutputStream() methods of the NXTComm object:</p>
      <ul>
        <li>
          <p class="western">public OutputStream getOutputStream();</p>
        </li>
        <li>
          <p class="western">public InputStream getInputStream();</p>
        </li>
      </ul>
      <p class="body-text-4-western">From these you can construct a
DataInputStream and a DataOutputStream and send data to the receiving
NXT.</p>
      <p class="body-text-4-western"><br>
      <br>
      </p>
      <p class="body-text-4-western">The complete BTSend sample is in
the samples folder.</p>
      <p class="western"><br>
      <br>
      </p>
      <p class="western"><a href="#1.Communications%7Coutline"><font
 color="#0000ff"><u>Back to top</u></font></a></p>
      <p class="western"><br>
      <br>
      </p>
      <h1 class="western" style="page-break-after: avoid;"><a
 name="2.Advanced Communications|outline"></a><a
 name="2.Advanced Communications|outline"></a> Advanced Communications</h1>
      <h2 class="western"><a name="2.1.Controlling a remote NXT|outline"></a>
Controlling a remote NXT</h2>
      <p class="body-text-2-western">The RemoteNXT class allows one NXT
running leJOS to control another, remote NXT, running leJOS or the
standard LEGO firmware. It uses the LEGO Communications Protocol (LCP)
over Bluetooth to control the remote NXT.</p>
      <p class="body-text-2-western">Currently, the class is limited
and I2C and RCX sensors are not supported, and the motors must be used
in a simple way as the regulation thread is not used.</p>
      <p class="body-text-2-western">To access a remote NXT, you use
the constructor:</p>
      <ul>
        <li>
          <p class="western">public RemoteNXT(String name) throws
IOException</p>
        </li>
      </ul>
      <p class="body-text-2-western">Example: </p>
      <p class="close-western"><span id="Frame12" dir="ltr"
 style="border: 1px solid rgb(0, 0, 0); padding: 0.05in 0.1in; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; width: 4.35in; height: 2.22in; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
      <p class="close-western"><font color="#7f0055"><font
 face="Courier New, monospace"><font size="2"><b>try</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">{</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(</font></font></font><font
 color="#2a00ff"><font face="Courier New, monospace"><font size="2">"Connecting..."</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">,0,0);</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">nxt
= </font></font></font><font color="#7f0055"><font
 face="Courier New, monospace"><font size="2"><b>new</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">RemoteNXT(</font></font></font><font
 color="#2a00ff"><font face="Courier New, monospace"><font size="2">"NXT"</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">);</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>clear</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">();</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(</font></font></font><font
 color="#2a00ff"><font face="Courier New, monospace"><font size="2">"Connected"</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">,0,0);</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">Thread.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>sleep</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(2000);</font></font></font></p>
      <p class="close-western"><font color="#000000"><font
 face="Courier New, monospace"><font size="2">} </font></font></font><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>catch</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">(IOException ioe) {</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>clear</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">();</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(</font></font></font><font
 color="#2a00ff"><font face="Courier New, monospace"><font size="2">"Conn
Failed"</font></font></font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">,0,0);</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">Thread.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>sleep</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(2000);</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">System.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>exit</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(1);</font></font></font></p>
      <p class="close-western">}</p>
      </span><br clear="left">
      <br>
      <br>
      </p>
      <p class="body-text-2-western">The name of the remote NXT must
have already been added to the known devices of the initiating NXT by
do a Bluetooth search followed by &#8220;Add&#8221; fron the leJOS NXJ Bluetooth
menu.</p>
      <p class="body-text-2-western">The constructor opens the
connection and creates instances of the remote motor and sensor ports.</p>
      <p class="body-text-2-western">It is then possible to get access
to information about the remote NXT by using the methods:</p>
      <ul>
        <li>
          <p class="western">public String getBrickName()</p>
        </li>
        <li>
          <p class="western">public String getBluetoothAddress()</p>
        </li>
        <li>
          <p class="western">public int getFlashMemory()</p>
        </li>
        <li>
          <p class="western">public String getFirmwareVersion()</p>
        </li>
        <li>
          <p class="western">public String getProtocolVersion()</p>
        </li>
      </ul>
      <p class="body-text-2-western">Example:</p>
      <p class="western"><span id="Frame13" dir="ltr"
 style="border: 1px solid rgb(0, 0, 0); padding: 0.05in 0.1in; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; width: 5.31in; height: 1.09in; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
      <p class="close-western"><font color="#000000"><font
 face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(nxt.getBrickName(),
0, 6);</font></font></font></p>
      <p class="close-western"><font color="#000000"><font
 face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(nxt.getFirmwareVersion(),
0, 7);</font></font></font></p>
      <p class="close-western"><font color="#000000"><font
 face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(nxt.getProtocolVersion(),
4, 7);</font></font></font></p>
      <p class="close-western"><font color="#000000"><font
 face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawInt</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(nxt.getFlashMemory(),
6, 8, 7);</font></font></font></p>
      </span><br clear="left">
      <br>
      <br>
      </p>
      <p class="body-text-2-western">There are also methods that act on
the remote NXT:</p>
      <ul>
        <li>
          <p class="western">public byte deleteFlashMemory()</p>
        </li>
      </ul>
      <p class="western">A remote Battery object is created that can be
used to get the voltage of the remote battery using the normal Battery
methods.</p>
      <p class="western">Example:</p>
      <p class="western"><span id="Frame14" dir="ltr"
 style="border: 1px solid rgb(0, 0, 0); padding: 0.05in 0.1in; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; width: 6.25in; height: 0.46in; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
      <p class="close-western"><font color="#000000"><font
 face="Courier New, monospace"><font style="font-size: 9pt;" size="2">LCD.</font></font></font><font
 face="Courier New, monospace"><font style="font-size: 9pt;" size="2">drawString(
"Battery: " + </font></font><font color="#000000"><font
 face="Courier New, monospace"><font style="font-size: 9pt;" size="2">nxt.</font></font></font><font
 color="#0000c0"><font face="Courier New, monospace"><font
 style="font-size: 9pt;" size="2">Battery</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font
 style="font-size: 9pt;" size="2">.getVoltageMilliVolt()</font></font></font>
      <font face="Courier New, monospace"><font style="font-size: 9pt;"
 size="2">0,4);</font></font></p>
      </span><br clear="left">
      <br>
      <br>
      </p>
      <p class="western">Objects are also created for the sensor ports
of the remote NXT. These are accessed as S1, S2, S3 and S4.</p>
      <p class="western">Local sensor objects can then be created using
these ports and use exactly as if they were connected to a local sensor
port.</p>
      <p class="western">Example:</p>
      <p class="western"><span id="Frame15" dir="ltr"
 style="border: 1px solid rgb(0, 0, 0); padding: 0.05in 0.1in; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; width: 4.39in; height: 0.52in; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
      <p class="close-western">LightSensor light = new
LightSensor(nxt.S1);</p>
      <p class="close-western">LCD.drawString("Light: " +
light.readValue(),0,5);</p>
      </span><br clear="left">
      <br>
      <br>
      </p>
      <p class="western">Motor objects are created for the remote
motors. They are named A, B and C.</p>
      <p class="western">These can be used in the normal way, e.g: </p>
      <p class="western"
 style="margin-bottom: 0in; widows: 0; orphans: 0;" align="left"> <span
 id="Frame16" dir="ltr"
 style="border: 1px solid rgb(0, 0, 0); padding: 0.05in 0.1in; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; width: 2.51in; height: 1.06in; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
      <p class="close-western">nxt.A.setSpeed(360);</p>
      <p class="close-western">nxt.A.forward();</p>
      <p class="close-western">nxt.A.stop();</p>
      <p class="close-western">nxt.A.backward();</p>
      </span><br clear="left">
      <br>
      </p>
      <p class="western"
 style="margin-bottom: 0in; widows: 0; orphans: 0;" align="left"> <br>
      </p>
      <p class="western"
 style="margin-bottom: 0in; widows: 0; orphans: 0;" align="left"> <br>
      </p>
      <p class="western"><a href="#1.Communications%7Coutline"><font
 color="#0000ff"><u>Back to top</u></font></a></p>
      <h2 class="western"><a
 name="2.2.Communications External Bluetooth devices|outline"></a> <font
 color="#ff6600"><font face="Arial, sans-serif"><font
 style="font-size: 13pt;" size="3"><span lang="en-GB"><b>Communications</b></span></font></font></font>
External Bluetooth devices</h2>
      <p class="western">The NXT can connect to external Bluetooth
devices that implement the Serial Port Profile (SPP).</p>
      <p class="western">Such devices can be searched for on the
Bluetooth menu and added to the known devices.</p>
      <h3 class="western" lang="en-GB">GPS</h3>
      <p class="western">leJOS supports external Bluetooth GPS
receivers that support the NMEA protocol via the GPS and NMEASentence
classes. NMEASentence is a utility class used by GPS, and is not
directly accessed.</p>
      <p class="western">One such device that has been tested with
leJOS NXJ is the Holux M-1200.</p>
      <p class="western">Most such devices have a PIN that is required
to connect to them, but it may have a default value such as &#8220;0000&#8221;.</p>
      <p class="western">To connect to a GPS device, you do:</p>
      <p class="close-western"><span id="Frame17" dir="ltr"
 style="border: 1px solid rgb(0, 0, 0); padding: 0.05in 0.1in; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; width: 5.89in; height: 5.58in; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
      <p class="close-western">final byte[] pin = {(byte) '0', (byte)
'0', (byte) '0', (byte) '0'};</p>
      <p class="close-western">BTRemoteDevice btGPS =
Bluetooth.getKnownDevice(name); </p>
      <p class="close-western"><font color="#7f0055"><font
 face="Courier New, monospace"><font size="2"><b>if</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">(btrd == </font></font></font><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>null</b></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">) {</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(</font></font></font><font
 color="#2a00ff"><font face="Courier New, monospace"><font size="2">"No
such device"</font></font></font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">, 0, 0);</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">Thread.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>sleep</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(2000);</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">System.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>exit</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(1);</font></font></font></p>
      <p class="close-western">}</p>
      <p class="close-western">btGPS =
Bluetooth.connect(btrd.getDeviceAddr(), pin);</p>
      <p class="close-western"><font color="#7f0055"><font
 face="Courier New, monospace"><font size="2"><b>if</b></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(btGPS
== </font></font></font><font color="#7f0055"><font
 face="Courier New, monospace"><font size="2"><b>null</b></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">)</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(</font></font></font><font
 color="#2a00ff"><font face="Courier New, monospace"><font size="2">"No
Connection"</font></font></font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">, 0, 1);</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">Thread.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>sleep</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(2000);</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">System.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>exit</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(1);</font></font></font></p>
      <p class="close-western"><font face="Courier New, monospace"><font
 size="2">} </font></font><font color="#7f0055"><font
 face="Courier New, monospace"><font size="2"><b>else {</b></font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(</font></font></font><font
 color="#2a00ff"><font face="Courier New, monospace"><font size="2">"Connected!"</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">,
0, 1);</font></font></font></p>
      <p class="close-western">}</p>
      <p class="close-western"><font color="#000000"><font
 face="Courier New, monospace"><font size="2">GPS gps = </font></font></font><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>null</b></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">;</font></font></font></p>
      <p class="close-western">InputStream in;</p>
      <p class="close-western"><font color="#7f0055"><font
 face="Courier New, monospace"><font size="2"><b>try</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">{</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;">in =
btGPS.openInputStream();</p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">gps
= </font></font></font><font color="#7f0055"><font
 face="Courier New, monospace"><font size="2"><b>new</b></font></font></font><font
 color="#000000"> </font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">GPS(in);</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(</font></font></font><font
 color="#2a00ff"><font face="Courier New, monospace"><font size="2">"GPS
Online"</font></font></font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">, 0, 6);</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">} </font></font></font><font
 color="#7f0055"><font face="Courier New, monospace"><font size="2"><b>catch</b></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(Exception
e) {</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">LCD.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>drawString</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(</font></font></font><font
 color="#2a00ff"><font face="Courier New, monospace"><font size="2">"GPS
Connect Fail"</font></font></font><font color="#000000"><font
 face="Courier New, monospace"><font size="2">, 0, 6);</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">Thread.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>sleep</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(2000);</font></font></font></p>
      <p class="close-western" style="margin-left: 0.79in;"><font
 color="#000000"><font face="Courier New, monospace"><font size="2">System.</font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2"><i>exit</i></font></font></font><font
 color="#000000"><font face="Courier New, monospace"><font size="2">(1);</font></font></font></p>
      <p class="close-western">}</p>
      </span><br clear="left">
      <br>
      <br>
      </p>
      <p class="western">As you see from this example, the GPS
constructor takes the input stream from the Bluetooth connection as a
parameter:</p>
      <ul>
        <li>
          <p class="western">public GPS(InputStream in)</p>
        </li>
      </ul>
      <p class="western">It uses the NMEASentence class to process
messages (known as sentences) from the Bluetooth device. Current only
the $GPGGA sentence that gives the current latitude, longitude and
altitude, is processed.</p>
      <p class="western">To read the current values of latitude,
longitude and altitude, you use the methods:</p>
      <ul>
        <li>
          <p class="western">public float getLatitude()</p>
        </li>
        <li>
          <p class="western">public float getLongitude()</p>
        </li>
        <li>
          <p class="western">public float getAltitude()</p>
        </li>
      </ul>
      <p class="western">You can also get the time stamp corresponding
to these values by:</p>
      <ul>
        <li>
          <p class="western">public int getTime()</p>
        </li>
      </ul>
      <p class="western"><br>
      <br>
      </p>
      <p class="western"><a href="#1.Communications%7Coutline"><font
 color="#0000ff"><u>Back to top</u></font></a></p>
      <h2 class="western"><a
 name="2.3.Communicating with the RCX|outline"></a> Communicating with
the RCX</h2>
      <h3 class="western" lang="en-GB">RCXLink</h3>
      <p class="western">IR communication with the RCX can be done
using the Mindsensors NRLink RCX IR adapter. The software abstraction
of this device is the RCXLink class. The constructor is:</p>
      <ul>
        <li>
          <p class="western">public RCXLink(I2CPort port)</p>
        </li>
      </ul>
      <p class="western">For example: </p>
      <p class="western"><span id="Frame18" dir="ltr"
 style="border: 1px solid rgb(0, 0, 0); padding: 0.05in 0.1in; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; width: 3.72in; height: 0.48in; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
      <p class="close-western">RCXLink link = new
RCXLink(SensorPort.S1);</p>
      </span><br clear="left">
      <br>
      <br>
      </p>
      <p class="western">The NRLink-Nx supports a set of macros in ROM
and EEPROM that can be used to send messages to the RCX using the LEGO
RCX IR protocol. The EEPROM macos can be overwritten allowing the user
to define their own macros.</p>
      <p class="western">Macros can be run by:</p>
      <ul>
        <li>
          <p class="western">public void runMacro(int addr)</p>
        </li>
      </ul>
      <p class="western">There are convenience methods for running the
ROM macros:</p>
      <ul>
        <li>
          <p class="western">public void beep()</p>
        </li>
        <li>
          <p class="western">public void runProgram(int programNumber)</p>
        </li>
        <li>
          <p class="western">public void forwardStep(int id)</p>
        </li>
        <li>
          <p class="western">public void backwardStep(int id)</p>
        </li>
        <li>
          <p class="western">public void setRCXRangeShort()</p>
        </li>
        <li>
          <p class="western">public void setRCXRangeLong()</p>
        </li>
        <li>
          <p class="western">public void powerOff()</p>
        </li>
        <li>
          <p class="western">public void stopAllPrograms()</p>
        </li>
      </ul>
      <p class="western">A new macro in the EEPROM address range can be
defined by:</p>
      <ul>
        <li>
          <p class="western">public void defineMacro(int addr, byte[]
macro)</p>
        </li>
      </ul>
      <p class="western">There is a convenience method to define and
run a macro:</p>
      <p class="western"><br>
      <br>
      </p>
      <p class="western"><a href="#1.Communications%7Coutline"><font
 color="#0000ff"><u>Back to top</u></font></a></p>
      <p class="western"><br>
      <br>
      </p>
<!-- DO NOT TOUCH --> <br>
      <div class="NavBit"> <a target="_top"
 href="../ErrorHandlingAndDebugging/ErrorHandling_and_debugging.htm">&laquo;&nbsp;Previous</a>&nbsp;&#8226;&nbsp;<a
 href="../index.htm">TOC</a>&nbsp;&#8226;&nbsp;<a
 href="../PC_GUI/PCGUITools.htm">Next&nbsp;&raquo;</a> </div>
      <br>
      </td>
      <td> <br>
      </td>
    </tr>
  </tbody>
</table>
</body>
</html>
